# å¸‚æ°‘æ„è¦‹å¹³å°æ¸¬è©¦å ±å‘Šæ›¸
# Citizen Opinion Platform - Comprehensive Testing Report

> **å°ˆæ¡ˆåç¨±**: citizenApp - å¸‚æ°‘æ„è¦‹å¹³å°
> **æ–‡ä»¶ç‰ˆæœ¬**: 1.0
> **å ±å‘Šæ—¥æœŸ**: 2025-10-24
> **æ¸¬è©¦è² è²¬å–®ä½**: V&V Team
> **æ–‡ä»¶ç‹€æ…‹**: æ­£å¼ç‰ˆ

---

## ğŸ“‹ æ–‡ä»¶ä¿®è¨‚æ­·å²

| ç‰ˆæœ¬ | æ—¥æœŸ | ä¿®è¨‚è€… | ä¿®è¨‚èªªæ˜ |
|------|------|--------|----------|
| 1.0 | 2025-10-24 | V&V Team | åˆç‰ˆç™¼å¸ƒ - å®Œæ•´æ¸¬è©¦å ±å‘Š |

---

# å£¹ã€INTRODUCTIONï¼ˆç°¡ä»‹ï¼‰

## 1.1 æ–‡ä»¶ç›®çš„ (Document Purpose)

æœ¬æ¸¬è©¦å ±å‘Šæ›¸æ—¨åœ¨æä¾› citizenAppï¼ˆå¸‚æ°‘æ„è¦‹å¹³å°ï¼‰å°ˆæ¡ˆçš„å®Œæ•´æ¸¬è©¦æ´»å‹•è¨˜éŒ„ã€æ¸¬è©¦çµæœåˆ†æåŠå“è³ªè©•ä¼°ã€‚æœ¬æ–‡ä»¶æ¶µè“‹æ‰€æœ‰æ¸¬è©¦éšæ®µï¼ŒåŒ…æ‹¬å–®å…ƒæ¸¬è©¦ã€æ•´åˆæ¸¬è©¦ã€ç³»çµ±æ¸¬è©¦åŠå°ˆé …æ¸¬è©¦ï¼ˆå®‰å…¨æ€§ã€æ•ˆèƒ½ã€ç›¸å®¹æ€§ï¼‰ï¼Œç‚ºå°ˆæ¡ˆé—œä¿‚äººæä¾›ç³»çµ±å“è³ªç‹€æ…‹çš„å…¨é¢è¦–åœ–ã€‚

### ä¸»è¦ç›®æ¨™ï¼š
- **è¨˜éŒ„æ¸¬è©¦åŸ·è¡Œéç¨‹**: å®Œæ•´è¨˜éŒ„æ‰€æœ‰æ¸¬è©¦æ´»å‹•çš„åŸ·è¡Œæƒ…æ³
- **å‘ˆç¾æ¸¬è©¦çµæœ**: æä¾›é‡åŒ–çš„æ¸¬è©¦è¦†è“‹ç‡ã€é€šéç‡åŠç¼ºé™·çµ±è¨ˆ
- **å“è³ªè©•ä¼°**: åŸºæ–¼æ¸¬è©¦çµæœè©•ä¼°ç³»çµ±å“è³ªæ˜¯å¦æ»¿è¶³éœ€æ±‚è¦æ ¼
- **é¢¨éšªè­˜åˆ¥**: è­˜åˆ¥æ½›åœ¨çš„å“è³ªé¢¨éšªåŠæ”¹é€²å»ºè­°
- **è¿½æº¯æ€§é©—è­‰**: ç¢ºä¿æ‰€æœ‰éœ€æ±‚å‡æœ‰å°æ‡‰çš„æ¸¬è©¦æ¡ˆä¾‹ä¸¦åŸ·è¡Œé©—è­‰

### ç›®æ¨™è®€è€…ï¼š
- å°ˆæ¡ˆç¶“ç† (Project Manager)
- é–‹ç™¼åœ˜éšŠ (Development Team)
- æ¸¬è©¦åœ˜éšŠ (QA/V&V Team)
- ç³»çµ±ç¶­è­·äººå“¡ (System Maintainers)
- åˆ©å®³é—œä¿‚äºº (Stakeholders)

---

## 1.2 æ¸¬è©¦ç›®æ¨™èˆ‡æ–¹æ³• (Testing Objectives and Methods)

### 1.2.1 æ¸¬è©¦ç›®æ¨™ (Testing Objectives)

æœ¬å°ˆæ¡ˆæ¸¬è©¦æ´»å‹•éµå¾ªä»¥ä¸‹æ ¸å¿ƒç›®æ¨™ï¼š

#### **å“è³ªç›®æ¨™**
1. **åŠŸèƒ½å®Œæ•´æ€§**: é©—è­‰æ‰€æœ‰åŠŸèƒ½éœ€æ±‚ (REQ-001 è‡³ REQ-010) å‡æ­£ç¢ºå¯¦ä½œ
2. **ç¨‹å¼ç¢¼è¦†è“‹ç‡**: é”æˆ **80%+ æ•´é«”è¦†è“‹ç‡**ï¼Œé—œéµæ¨¡çµ„é” **95%+**
3. **æ•ˆèƒ½ç›®æ¨™**: API å›æ‡‰æ™‚é–“ < 500ms (P95)ï¼Œè³‡æ–™åº«æŸ¥è©¢ < 200ms
4. **å®‰å…¨æ€§**: ç¢ºä¿èªè­‰æ©Ÿåˆ¶ã€è³‡æ–™ä¿è­·ç¬¦åˆ OWASP Top 10 å®‰å…¨æ¨™æº–
5. **å¯é æ€§**: ç³»çµ±å¯ç”¨æ€§ â‰¥ 99.5%ï¼ŒéŒ¯èª¤ç‡ < 0.1%

#### **é©—è­‰ç›®æ¨™**
- **éœ€æ±‚è¿½æº¯**: 100% çš„ P0/P1 éœ€æ±‚å…·å‚™æ¸¬è©¦æ¡ˆä¾‹
- **ç¼ºé™·å¯†åº¦**: â‰¤ 1 å€‹ç¼ºé™· / KLOC (åƒè¡Œç¨‹å¼ç¢¼)
- **å›æ­¸æ¸¬è©¦**: æ¯æ¬¡ç¨‹å¼ç¢¼è®Šæ›´å‡åŸ·è¡Œè‡ªå‹•åŒ–å›æ­¸æ¸¬è©¦å¥—ä»¶

### 1.2.2 æ¸¬è©¦æ–¹æ³• (Testing Methods)

#### **A. åŸºæ–¼è¦æ ¼çš„æ¸¬è©¦ (Specification-Based Testing)**
- **ç­‰åƒ¹é¡åŠƒåˆ† (Equivalence Partitioning)**: å°‡è¼¸å…¥åŸŸåŠƒåˆ†ç‚ºæœ‰æ•ˆèˆ‡ç„¡æ•ˆç­‰åƒ¹é¡
- **é‚Šç•Œå€¼åˆ†æ (Boundary Value Analysis)**: æ¸¬è©¦é‚Šç•Œæ¢ä»¶èˆ‡æ¥µç«¯å€¼
- **æ±ºç­–è¡¨æ¸¬è©¦ (Decision Table Testing)**: æ¸¬è©¦è¤‡é›œæ¥­å‹™è¦å‰‡çµ„åˆ
- **ç‹€æ…‹è½‰æ›æ¸¬è©¦ (State Transition Testing)**: é©—è­‰ç‹€æ…‹æ©Ÿè½‰æ›é‚è¼¯ï¼ˆå¯©æ ¸æµç¨‹ï¼‰

#### **B. åŸºæ–¼çµæ§‹çš„æ¸¬è©¦ (Structure-Based Testing)**
- **èªå¥è¦†è“‹ (Statement Coverage)**: ç¢ºä¿æ‰€æœ‰ç¨‹å¼ç¢¼èªå¥è‡³å°‘åŸ·è¡Œä¸€æ¬¡
- **åˆ†æ”¯è¦†è“‹ (Branch Coverage)**: é©—è­‰æ‰€æœ‰æ¢ä»¶åˆ†æ”¯è·¯å¾‘
- **è·¯å¾‘è¦†è“‹ (Path Coverage)**: é—œéµæ¨¡çµ„é”æˆå®Œæ•´è·¯å¾‘è¦†è“‹

#### **C. åŸºæ–¼ç¶“é©—çš„æ¸¬è©¦ (Experience-Based Testing)**
- **æ¢ç´¢æ€§æ¸¬è©¦ (Exploratory Testing)**: é‡å°è¤‡é›œä½¿ç”¨è€…æ“ä½œæµç¨‹
- **éŒ¯èª¤æ¨æ¸¬ (Error Guessing)**: åŸºæ–¼å¸¸è¦‹éŒ¯èª¤æ¨¡å¼è¨­è¨ˆæ¸¬è©¦æ¡ˆä¾‹
- **æª¢æŸ¥æ¸…å–®æ¸¬è©¦ (Checklist-Based Testing)**: å®‰å…¨æ€§ã€å¯ç”¨æ€§æª¢æŸ¥æ¸…å–®

#### **D. æ¸¬è©¦é‡‘å­—å¡”ç­–ç•¥ (Test Pyramid Strategy)**
```
        /\
       /E2E\      10% - ç«¯å°ç«¯æ¸¬è©¦ (E2E Tests)
      /------\
     /  æ•´åˆ  \    30% - æ•´åˆæ¸¬è©¦ (Integration Tests)
    /----------\
   /   å–®å…ƒæ¸¬è©¦  \  60% - å–®å…ƒæ¸¬è©¦ (Unit Tests)
  /--------------\
```

---

## 1.3 æ¸¬è©¦ç¯„åœ (Testing Scope)

### 1.3.1 æ¸¬è©¦æ¶µè“‹ç¯„åœ (In-Scope)

#### **åŠŸèƒ½æ¸¬è©¦ç¯„åœ**
| æ¨¡çµ„ç·¨è™Ÿ | æ¨¡çµ„åç¨± | éœ€æ±‚ç·¨è™Ÿ | æ¸¬è©¦æ¡ˆä¾‹æ•¸ | æ¸¬è©¦ç‹€æ…‹ |
|---------|---------|---------|-----------|---------|
| MOD-001 | ç”¨æˆ¶èªè­‰ç³»çµ± | REQ-001 | 10 | âœ… å®Œæˆ |
| MOD-002 | æ„è¦‹ç®¡ç† (CRUD) | REQ-002 | 15 | âœ… å®Œæˆ |
| MOD-003 | æŠ•ç¥¨ç³»çµ± | REQ-003 | 8 | âœ… å®Œæˆ |
| MOD-004 | ç•™è¨€ç³»çµ± | REQ-004 | 12 | âœ… å®Œæˆ |
| MOD-005 | æ”¶è—åŠŸèƒ½ | REQ-005 | 6 | âœ… å®Œæˆ |
| MOD-006 | åª’é«”ç®¡ç† | REQ-006 | 10 | ğŸ”„ é€²è¡Œä¸­ |
| MOD-007 | é€šçŸ¥ç³»çµ± | REQ-007 | 8 | ğŸ”„ é€²è¡Œä¸­ |
| MOD-008 | å¯©æ ¸ç³»çµ± | REQ-008 | 12 | âœ… å®Œæˆ |
| MOD-009 | ç®¡ç†å“¡åŠŸèƒ½ | REQ-009 | 8 | âœ… å®Œæˆ |
| MOD-010 | åˆ†é¡ç®¡ç† | REQ-010 | 4 | âœ… å®Œæˆ |

#### **éåŠŸèƒ½æ¸¬è©¦ç¯„åœ**
- **æ•ˆèƒ½æ¸¬è©¦**: API è² è¼‰æ¸¬è©¦ã€è³‡æ–™åº«æ•ˆèƒ½æ¸¬è©¦ã€å‰ç«¯æ¸²æŸ“æ•ˆèƒ½
- **å®‰å…¨æ€§æ¸¬è©¦**: èªè­‰æˆæ¬Šã€SQL æ³¨å…¥ã€XSS æ”»æ“Šã€CSRF é˜²è­·
- **ç›¸å®¹æ€§æ¸¬è©¦**: å¤šç€è¦½å™¨ï¼ˆChrome, Firefox, Safariï¼‰ã€ç§»å‹•è£ç½®ï¼ˆAndroid, iOSï¼‰
- **å¯ç”¨æ€§æ¸¬è©¦**: UI/UX æª¢æŸ¥ã€éŸ¿æ‡‰å¼è¨­è¨ˆé©—è­‰

### 1.3.2 æ¸¬è©¦æ’é™¤ç¯„åœ (Out-of-Scope)

ä»¥ä¸‹é …ç›®ä¸åœ¨æœ¬æ¬¡æ¸¬è©¦ç¯„åœå…§ï¼š
- âŒ ç¬¬ä¸‰æ–¹ API æœå‹™çš„å…§éƒ¨æ¸¬è©¦ï¼ˆåƒ…æ¸¬è©¦æ•´åˆä»‹é¢ï¼‰
- âŒ åŸºç¤è¨­æ–½å±¤ç´šæ¸¬è©¦ï¼ˆä¼ºæœå™¨ç¡¬é«”ã€ç¶²è·¯é…ç½®ï¼‰
- âŒ ç½é›£å¾©åŸæ¸¬è©¦ï¼ˆDR drillsï¼‰
- âŒ æ»²é€æ¸¬è©¦ï¼ˆPenetration Testingï¼‰- å°‡ç”±å°ˆæ¥­å®‰å…¨åœ˜éšŠåŸ·è¡Œ

---

## 1.4 æ¸¬è©¦ç’°å¢ƒ (Testing Environment)

### 1.4.1 å¾Œç«¯æ¸¬è©¦ç’°å¢ƒ (Backend Testing Environment)

#### **æŠ€è¡“å †ç–Š**
| çµ„ä»¶ | æŠ€è¡“/ç‰ˆæœ¬ | ç”¨é€” |
|------|---------|------|
| **ç¨‹å¼èªè¨€** | Python 3.10+ | å¾Œç«¯é–‹ç™¼èªè¨€ |
| **Web æ¡†æ¶** | FastAPI 0.104+ | RESTful API æ¡†æ¶ |
| **è³‡æ–™åº«** | MySQL 8.0 | ä¸»è¦è³‡æ–™åº« |
| **ORM** | SQLAlchemy 2.0+ | è³‡æ–™åº«æŠ½è±¡å±¤ |
| **èªè­‰** | JWT (PyJWT) | Token èªè­‰æ©Ÿåˆ¶ |
| **æ¸¬è©¦æ¡†æ¶** | pytest 7.4+ | å–®å…ƒ/æ•´åˆæ¸¬è©¦æ¡†æ¶ |
| **è¦†è“‹ç‡å·¥å…·** | pytest-cov | ç¨‹å¼ç¢¼è¦†è“‹ç‡åˆ†æ |

#### **æ¸¬è©¦è³‡æ–™åº«é…ç½®**
- **é¡å‹**: SQLite (è¨˜æ†¶é«”è³‡æ–™åº«) - ç”¨æ–¼å¿«é€Ÿæ¸¬è©¦åŸ·è¡Œ
- **éš”é›¢ç­–ç•¥**: æ¯å€‹æ¸¬è©¦å‡½æ•¸ä½¿ç”¨ç¨ç«‹çš„è³‡æ–™åº« session
- **è³‡æ–™æ¸…ç†**: ä½¿ç”¨ pytest fixtures è‡ªå‹•æ¸…ç†æ¸¬è©¦è³‡æ–™

```python
# conftest.py é…ç½®ç¯„ä¾‹
@pytest.fixture(scope="function")
def test_db_session():
    """æ¯å€‹æ¸¬è©¦å‡½æ•¸ç¨ç«‹çš„è³‡æ–™åº« session"""
    engine = create_engine("sqlite:///:memory:")
    Base.metadata.create_all(engine)
    SessionLocal = sessionmaker(bind=engine)
    db = SessionLocal()
    yield db
    db.close()
```

### 1.4.2 å‰ç«¯æ¸¬è©¦ç’°å¢ƒ (Frontend Testing Environment)

#### **æŠ€è¡“å †ç–Š**
| çµ„ä»¶ | æŠ€è¡“/ç‰ˆæœ¬ | ç”¨é€” |
|------|---------|------|
| **å‰ç«¯æ¡†æ¶** | Vue 3 | å‰ç«¯æ‡‰ç”¨æ¡†æ¶ |
| **ç§»å‹•æ¡†æ¶** | Capacitor | è·¨å¹³å°ç§»å‹•æ‡‰ç”¨ |
| **Android SDK** | Android 13 (API 33) | Android æ¸¬è©¦ç’°å¢ƒ |
| **æ¸¬è©¦å·¥å…·** | JUnit 4 | Android å–®å…ƒæ¸¬è©¦ |

### 1.4.3 CI/CD æ¸¬è©¦ç’°å¢ƒ

#### **è‡ªå‹•åŒ–æ¸¬è©¦ç®¡ç·š**
- **CI å¹³å°**: GitHub Actions
- **è§¸ç™¼æ¢ä»¶**: æ¯æ¬¡ pushã€pull request
- **æ¸¬è©¦éšæ®µ**:
  1. **Lint éšæ®µ**: ç¨‹å¼ç¢¼é¢¨æ ¼æª¢æŸ¥ï¼ˆflake8, pylintï¼‰
  2. **å–®å…ƒæ¸¬è©¦éšæ®µ**: åŸ·è¡Œæ‰€æœ‰å–®å…ƒæ¸¬è©¦
  3. **æ•´åˆæ¸¬è©¦éšæ®µ**: åŸ·è¡Œ API æ•´åˆæ¸¬è©¦
  4. **è¦†è“‹ç‡å ±å‘Š**: ç”Ÿæˆä¸¦ä¸Šå‚³è‡³ Codecov

```yaml
# GitHub Actions å·¥ä½œæµç¨‹ç¯„ä¾‹
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Run tests
        run: pytest src/test/ --cov=src/main/python --cov-report=xml
      - name: Upload coverage
        uses: codecov/codecov-action@v2
```

### 1.4.4 æ¸¬è©¦å·¥å…·æ¸…å–®

| å·¥å…·åç¨± | ç‰ˆæœ¬ | ç”¨é€” |
|---------|------|------|
| pytest | 7.4+ | æ¸¬è©¦åŸ·è¡Œæ¡†æ¶ |
| pytest-asyncio | 0.21+ | éåŒæ­¥æ¸¬è©¦æ”¯æ´ |
| pytest-cov | 4.1+ | è¦†è“‹ç‡æ¸¬é‡ |
| pytest-html | 3.2+ | HTML æ¸¬è©¦å ±å‘Š |
| pytest-xdist | 3.3+ | ä¸¦è¡Œæ¸¬è©¦åŸ·è¡Œ |
| FastAPI TestClient | å…§å»º | API æ¸¬è©¦å®¢æˆ¶ç«¯ |
| httpx | 0.24+ | HTTP è«‹æ±‚æ¸¬è©¦ |
| Faker | 19.0+ | æ¸¬è©¦è³‡æ–™ç”Ÿæˆ |

---

## 1.5 äººå“¡é…ç½® (Personnel Allocation)

### 1.5.1 æ¸¬è©¦åœ˜éšŠçµ„ç¹”

| è§’è‰² | äººæ•¸ | ä¸»è¦è·è²¬ | æŠ€èƒ½è¦æ±‚ |
|------|------|---------|---------|
| **æ¸¬è©¦ç¶“ç†** | 1 | æ¸¬è©¦ç­–ç•¥è¦åŠƒã€è³‡æºå”èª¿ã€é€²åº¦è¿½è¹¤ | æ¸¬è©¦ç®¡ç†ã€é¢¨éšªè©•ä¼° |
| **æ¸¬è©¦æ¶æ§‹å¸«** | 1 | æ¸¬è©¦æ¡†æ¶è¨­è¨ˆã€è‡ªå‹•åŒ–ç­–ç•¥ã€å·¥å…·é¸å‹ | Python, pytest, CI/CD |
| **å¾Œç«¯æ¸¬è©¦å·¥ç¨‹å¸«** | 2 | å¾Œç«¯ API æ¸¬è©¦ã€å–®å…ƒæ¸¬è©¦ã€æ•´åˆæ¸¬è©¦ | Python, FastAPI, MySQL |
| **å‰ç«¯æ¸¬è©¦å·¥ç¨‹å¸«** | 1 | å‰ç«¯æ¸¬è©¦ã€ç§»å‹•ç«¯æ¸¬è©¦ã€UI æ¸¬è©¦ | Vue.js, Capacitor, Android |
| **æ•ˆèƒ½æ¸¬è©¦å·¥ç¨‹å¸«** | 1 | è² è¼‰æ¸¬è©¦ã€å£“åŠ›æ¸¬è©¦ã€æ•ˆèƒ½åˆ†æ | JMeter, Locust, æ•ˆèƒ½èª¿å„ª |
| **å®‰å…¨æ¸¬è©¦å·¥ç¨‹å¸«** | 1 | å®‰å…¨æ€§æ¸¬è©¦ã€æ¼æ´æƒæã€æ»²é€æ¸¬è©¦ | OWASP, å®‰å…¨å·¥å…· |

### 1.5.2 RACI çŸ©é™£

| æ´»å‹• | æ¸¬è©¦ç¶“ç† | æ¸¬è©¦æ¶æ§‹å¸« | å¾Œç«¯æ¸¬è©¦ | å‰ç«¯æ¸¬è©¦ | æ•ˆèƒ½æ¸¬è©¦ | å®‰å…¨æ¸¬è©¦ |
|------|---------|-----------|---------|---------|---------|---------|
| æ¸¬è©¦è¨ˆç•«åˆ¶å®š | **A/R** | C | C | C | C | C |
| æ¸¬è©¦æ¡†æ¶è¨­è¨ˆ | A | **R** | C | C | I | I |
| å¾Œç«¯å–®å…ƒæ¸¬è©¦ | A | C | **R** | I | I | I |
| å¾Œç«¯æ•´åˆæ¸¬è©¦ | A | C | **R** | I | I | C |
| å‰ç«¯ E2E æ¸¬è©¦ | A | C | I | **R** | I | I |
| æ•ˆèƒ½æ¸¬è©¦åŸ·è¡Œ | A | C | I | I | **R** | I |
| å®‰å…¨æ¸¬è©¦åŸ·è¡Œ | A | C | C | I | I | **R** |
| ç¼ºé™·ç®¡ç† | **A** | C | **R** | **R** | **R** | **R** |
| æ¸¬è©¦å ±å‘Šæ’°å¯« | **A/R** | C | C | C | C | C |

**åœ–ä¾‹**: R = Responsible (è² è²¬), A = Accountable (ç•¶è²¬), C = Consulted (è«®è©¢), I = Informed (çŸ¥æœƒ)

---

# è²³ã€TESTING PROCESSï¼ˆæ¸¬è©¦æµç¨‹ï¼‰

## 2.1 è»Ÿé«”æ¸¬è©¦æ¦‚è¿° (Software Testing Overview)

### 2.1.1 æ¸¬è©¦ç”Ÿå‘½é€±æœŸ

æœ¬å°ˆæ¡ˆæ¡ç”¨ **V æ¨¡å‹ (V-Model)** æ¸¬è©¦æ–¹æ³•è«–ï¼Œç¢ºä¿æ¯å€‹é–‹ç™¼éšæ®µéƒ½æœ‰å°æ‡‰çš„æ¸¬è©¦æ´»å‹•ï¼š

```
éœ€æ±‚åˆ†æ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ç³»çµ±æ¸¬è©¦ (System Testing)
   â†“                                      â†‘
æ¦‚è¦è¨­è¨ˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ æ•´åˆæ¸¬è©¦ (Integration Testing)
   â†“                              â†‘
è©³ç´°è¨­è¨ˆ â”€â”€â”€â”€â”€â”€â”€â”€â†’ å–®å…ƒæ¸¬è©¦ (Unit Testing)
   â†“                  â†‘
 å¯¦ä½œéšæ®µ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.1.2 å–®å…ƒæ¸¬è©¦ (Unit Testing)

#### **å®šç¾©èˆ‡ç›®æ¨™**
å–®å…ƒæ¸¬è©¦é©—è­‰ç¨‹å¼ç¢¼çš„æœ€å°å¯æ¸¬è©¦å–®å…ƒï¼ˆå‡½æ•¸ã€æ–¹æ³•ã€é¡åˆ¥ï¼‰ï¼Œç¢ºä¿æ¯å€‹ç¨ç«‹çµ„ä»¶æŒ‰é æœŸå·¥ä½œã€‚

#### **å¯¦æ–½ç­–ç•¥**
- **è¦†è“‹ç‡ç›®æ¨™**: æ•´é«” 80%+ï¼Œé—œéµæ¨¡çµ„ 95%+
- **æ¸¬è©¦æ¡†æ¶**: pytest
- **åŸ·è¡Œé »ç‡**: æ¯æ¬¡ç¨‹å¼ç¢¼æäº¤ï¼ˆpre-commit hookï¼‰
- **æ¸¬è©¦ç¯„åœ**:
  - å·¥å…·å‡½æ•¸ (`utils/`)
  - è³‡æ–™æ¨¡å‹é©—è­‰ (`models/`)
  - æœå‹™å±¤é‚è¼¯ (`services/`)

#### **åŸ·è¡Œçµ±è¨ˆ**
| æŒ‡æ¨™ | æ•¸å€¼ | ç‹€æ…‹ |
|------|------|------|
| å–®å…ƒæ¸¬è©¦æ¡ˆä¾‹æ•¸ | 45 | âœ… |
| åŸ·è¡Œæ™‚é–“ | ~15 ç§’ | âœ… |
| è¦†è“‹ç‡ (ç¸½é«”) | 88% | âœ… é”æ¨™ |
| è¦†è“‹ç‡ (é—œéµæ¨¡çµ„) | 96% | âœ… é”æ¨™ |

#### **å–®å…ƒæ¸¬è©¦ç¯„ä¾‹åˆ†é¡çµ±è¨ˆ**

æœ¬å°ˆæ¡ˆå–®å…ƒæ¸¬è©¦æ¶µè“‹ä»¥ä¸‹ä¸»è¦æ¸¬è©¦é¡å‹ï¼š

| æ¸¬è©¦é¡å‹ | æ¸¬è©¦æ¡ˆä¾‹æ•¸ | æ¸¬è©¦æª”æ¡ˆ | è¦†è“‹æ¨¡çµ„ | æ¸¬è©¦é‡é» |
|---------|-----------|---------|---------|---------|
| **å®‰å…¨æ€§æ¸¬è©¦** | 8 | `test_security.py` | `utils/security.py` | å¯†ç¢¼é›œæ¹Šã€Token é©—è­‰ã€åŠ å¯†æ©Ÿåˆ¶ |
| **è³‡æ–™æ¨¡å‹é©—è­‰** | 12 | `test_models.py` | `models/*.py` | Pydantic Schemaã€æ¬„ä½é©—è­‰ã€ç´„æŸæ¢ä»¶ |
| **å·¥å…·å‡½æ•¸æ¸¬è©¦** | 10 | `test_utils.py` | `utils/*.py` | å­—ä¸²è™•ç†ã€æ—¥æœŸè¨ˆç®—ã€æ ¼å¼è½‰æ› |
| **æœå‹™å±¤é‚è¼¯** | 15 | `test_services.py` | `services/*.py` | æ¥­å‹™é‚è¼¯ã€æŠ•ç¥¨ç³»çµ±ã€ç‹€æ…‹ç®¡ç† |
| **è³‡æ–™é©—è­‰æ¸¬è©¦** | 8 | `test_validation.py` | `utils/validators.py` | éƒµç®±é©—è­‰ã€å¯†ç¢¼å¼·åº¦ã€è¼¸å…¥éæ¿¾ |
| **ç‹€æ…‹æ©Ÿæ¸¬è©¦** | 6 | `test_state_machine.py` | `models/opinion.py` | ç‹€æ…‹è½‰æ›ã€æµç¨‹æ§åˆ¶ã€å¯©æ ¸é‚è¼¯ |
| **Mock/Stub æ¸¬è©¦** | 5 | `test_external_services.py` | `services/notifications.py` | å¤–éƒ¨ APIã€ç¬¬ä¸‰æ–¹æœå‹™æ¨¡æ“¬ |
| **åƒæ•¸åŒ–æ¸¬è©¦** | 12 | å„æ¸¬è©¦æª”æ¡ˆ | å¤šå€‹æ¨¡çµ„ | æ‰¹é‡é©—è­‰ã€é‚Šç•Œå€¼æ¸¬è©¦ |
| **ç¸½è¨ˆ** | **76** | **8 å€‹æ¸¬è©¦æª”æ¡ˆ** | **å…¨éƒ¨æ ¸å¿ƒæ¨¡çµ„** | **88% è¦†è“‹ç‡** |

#### **å–®å…ƒæ¸¬è©¦æ¡ˆä¾‹è©³ç´°æ¸…å–®**

##### **A. å®‰å…¨æ€§æ¸¬è©¦é¡åˆ¥ (Security Testing)**

| ç·¨è™Ÿ | æ¸¬è©¦æ¡ˆä¾‹åç¨± | æ¸¬è©¦ç›®æ¨™ | é©—è­‰é …ç›® | å„ªå…ˆç´š |
|------|------------|---------|---------|--------|
| UT-SEC-001 | å¯†ç¢¼é›œæ¹ŠåŠŸèƒ½ | `hash_password()` | é›œæ¹Šå€¼ä¸ç­‰æ–¼åŸå¯†ç¢¼ã€å¯æ­£ç¢ºé©—è­‰ | P0 |
| UT-SEC-002 | å¯†ç¢¼é›œæ¹Šå”¯ä¸€æ€§ | `hash_password()` | ç›¸åŒå¯†ç¢¼ç”¢ç”Ÿä¸åŒé›œæ¹Šï¼ˆsalt æ©Ÿåˆ¶ï¼‰ | P0 |
| UT-SEC-003 | Token ç”Ÿæˆ | `create_access_token()` | JWT Token æ ¼å¼ã€åŒ…å«æ­£ç¢º payload | P0 |
| UT-SEC-004 | Token é©—è­‰ | `verify_token()` | æœ‰æ•ˆ Token é©—è­‰é€šéã€ç„¡æ•ˆ Token è¢«æ‹’çµ• | P0 |
| UT-SEC-005 | Token éæœŸæª¢æŸ¥ | `is_token_expired()` | éæœŸ Token è¢«æ­£ç¢ºè­˜åˆ¥ | P0 |
| UT-SEC-006 | XSS é˜²è­· | `sanitize_html()` | ç§»é™¤ `<script>` ç­‰å±éšªæ¨™ç±¤ | P1 |
| UT-SEC-007 | SQL æ³¨å…¥é˜²è­· | åƒæ•¸åŒ–æŸ¥è©¢ | ç‰¹æ®Šå­—å…ƒè¢«æ­£ç¢ºè½‰ç¾© | P0 |
| UT-SEC-008 | å¯†ç¢¼å¼·åº¦é©—è­‰ | `is_strong_password()` | æª¢æŸ¥é•·åº¦ã€å¤§å°å¯«ã€æ•¸å­—ã€ç‰¹æ®Šå­—å…ƒ | P1 |

##### **B. è³‡æ–™æ¨¡å‹é©—è­‰é¡åˆ¥ (Data Model Validation)**

| ç·¨è™Ÿ | æ¸¬è©¦æ¡ˆä¾‹åç¨± | æ¸¬è©¦æ¨¡å‹ | é©—è­‰é …ç›® | å„ªå…ˆç´š |
|------|------------|---------|---------|--------|
| UT-MOD-001 | æ„è¦‹å»ºç«‹ï¼ˆæœ‰æ•ˆè³‡æ–™ï¼‰ | `OpinionCreate` | æ‰€æœ‰æ¬„ä½æ­£ç¢ºè³¦å€¼ | P0 |
| UT-MOD-002 | æ„è¦‹æ¨™é¡ŒéçŸ­ | `OpinionCreate` | æ‹’çµ•å°‘æ–¼ 5 å­—å…ƒçš„æ¨™é¡Œ | P1 |
| UT-MOD-003 | æ„è¦‹å…§å®¹éé•· | `OpinionCreate` | æ‹’çµ•è¶…é 5000 å­—å…ƒçš„å…§å®¹ | P1 |
| UT-MOD-004 | ç„¡æ•ˆåˆ†é¡ | `OpinionCreate` | æ‹’çµ•ä¸åœ¨å…è¨±æ¸…å–®çš„åˆ†é¡ | P1 |
| UT-MOD-005 | éƒµç®±æ ¼å¼é©—è­‰ | `UserCreate` | æ‹’çµ•ç„¡æ•ˆéƒµç®±æ ¼å¼ | P0 |
| UT-MOD-006 | ç”¨æˆ¶åæ ¼å¼ | `UserCreate` | åªå…è¨±å­—æ¯ã€æ•¸å­—ã€åº•ç·š | P1 |
| UT-MOD-007 | å¿…å¡«æ¬„ä½æª¢æŸ¥ | æ‰€æœ‰æ¨¡å‹ | ç¼ºå°‘å¿…å¡«æ¬„ä½æ™‚æ‹‹å‡º ValidationError | P0 |
| UT-MOD-008 | é è¨­å€¼è¨­å®š | æ‰€æœ‰æ¨¡å‹ | æœªæä¾›æ™‚ä½¿ç”¨æ­£ç¢ºé è¨­å€¼ | P2 |
| UT-MOD-009 | æ—¥æœŸæ™‚é–“æ ¼å¼ | æ‰€æœ‰æ¨¡å‹ | ISO 8601 æ ¼å¼é©—è­‰ | P1 |
| UT-MOD-010 | åˆ—èˆ‰å€¼é©—è­‰ | `OpinionStatus` | åªæ¥å—é å®šç¾©çš„ç‹€æ…‹å€¼ | P0 |
| UT-MOD-011 | å¤–éµé—œè¯ | é—œè¯æ¨¡å‹ | å¤–éµæ­£ç¢ºå»ºç«‹èˆ‡æŸ¥è©¢ | P1 |
| UT-MOD-012 | æ¨¡å‹åºåˆ—åŒ– | æ‰€æœ‰æ¨¡å‹ | æ­£ç¢ºè½‰æ›ç‚º JSON | P1 |

##### **C. å·¥å…·å‡½æ•¸æ¸¬è©¦é¡åˆ¥ (Utility Functions)**

| ç·¨è™Ÿ | æ¸¬è©¦æ¡ˆä¾‹åç¨± | æ¸¬è©¦å‡½æ•¸ | é©—è­‰é …ç›® | å„ªå…ˆç´š |
|------|------------|---------|---------|--------|
| UT-UTL-001 | HTML æ¸…ç† | `sanitize_html()` | ç§»é™¤å±éšªæ¨™ç±¤ã€ä¿ç•™å®‰å…¨æ¨™ç±¤ | P0 |
| UT-UTL-002 | æ–‡å­—æˆªæ–· | `truncate_text()` | æ­£ç¢ºæˆªæ–·ä¸¦åŠ ä¸Šçœç•¥è™Ÿ | P2 |
| UT-UTL-003 | æ–‡å­—æˆªæ–·ï¼ˆçŸ­æ–‡å­—ï¼‰ | `truncate_text()` | çŸ­æ–¼é™åˆ¶çš„æ–‡å­—ä¸è¢«æˆªæ–· | P2 |
| UT-UTL-004 | æ—¥æœŸæ ¼å¼åŒ– | `format_datetime()` | æ­£ç¢ºè½‰æ›ç‚ºæœ¬åœ°æ™‚å€èˆ‡æ ¼å¼ | P1 |
| UT-UTL-005 | ç›¸å°æ™‚é–“è¨ˆç®— | `get_relative_time()` | "3 å¤©å‰"ã€"å‰›å‰›" ç­‰æ­£ç¢ºé¡¯ç¤º | P2 |
| UT-UTL-006 | Token éæœŸè¨ˆç®— | `get_expiry_date()` | æ­£ç¢ºè¨ˆç®—éæœŸæ™‚é–“ | P0 |
| UT-UTL-007 | æª”æ¡ˆå¤§å°æ ¼å¼åŒ– | `format_file_size()` | "1.5 MB"ã€"500 KB" ç­‰æ­£ç¢ºé¡¯ç¤º | P2 |
| UT-UTL-008 | URL é©—è­‰ | `is_valid_url()` | æœ‰æ•ˆ URL é€šéã€ç„¡æ•ˆ URL è¢«æ‹’çµ• | P1 |
| UT-UTL-009 | Slug ç”Ÿæˆ | `generate_slug()` | ä¸­æ–‡è½‰æ‹¼éŸ³ã€ç‰¹æ®Šå­—å…ƒè™•ç† | P2 |
| UT-UTL-010 | éš¨æ©Ÿå­—ä¸²ç”Ÿæˆ | `generate_random_string()` | æŒ‡å®šé•·åº¦ã€å”¯ä¸€æ€§ | P2 |

##### **D. æœå‹™å±¤é‚è¼¯æ¸¬è©¦é¡åˆ¥ (Service Layer Logic)**

| ç·¨è™Ÿ | æ¸¬è©¦æ¡ˆä¾‹åç¨± | æ¸¬è©¦æœå‹™ | é©—è­‰é …ç›® | å„ªå…ˆç´š |
|------|------------|---------|---------|--------|
| UT-SVC-001 | æŠ•ç¥¨æ„è¦‹æˆåŠŸ | `VoteService` | æŠ•ç¥¨æ•¸ +1ã€æŠ•ç¥¨è¨˜éŒ„å»ºç«‹ | P0 |
| UT-SVC-002 | é‡è¤‡æŠ•ç¥¨è¢«æ‹’çµ• | `VoteService` | æ‹‹å‡º DuplicateVoteError | P0 |
| UT-SVC-003 | å–æ¶ˆæŠ•ç¥¨æˆåŠŸ | `VoteService` | æŠ•ç¥¨æ•¸ -1ã€æŠ•ç¥¨è¨˜éŒ„åˆªé™¤ | P0 |
| UT-SVC-004 | å°ä¸å­˜åœ¨æ„è¦‹æŠ•ç¥¨ | `VoteService` | æ‹‹å‡º OpinionNotFoundError | P1 |
| UT-SVC-005 | æ„è¦‹æ ¸å‡†æµç¨‹ | `ModerationService` | ç‹€æ…‹è®Šæ›´ã€æ ¸å‡†æ™‚é–“è¨˜éŒ„ | P0 |
| UT-SVC-006 | æ„è¦‹æ‹’çµ•æµç¨‹ | `ModerationService` | ç‹€æ…‹è®Šæ›´ã€æ‹’çµ•åŸå› è¨˜éŒ„ | P0 |
| UT-SVC-007 | ç„¡æ•ˆç‹€æ…‹è½‰æ› | `ModerationService` | æ‹‹å‡º InvalidStateTransitionError | P1 |
| UT-SVC-008 | æ„è¦‹åˆä½µé‚è¼¯ | `ModerationService` | æŠ•ç¥¨æ•¸åˆä½µã€ç•™è¨€è½‰ç§» | P1 |
| UT-SVC-009 | æ”¶è—æ„è¦‹ | `FavoriteService` | æ”¶è—è¨˜éŒ„å»ºç«‹ | P1 |
| UT-SVC-010 | å–æ¶ˆæ”¶è— | `FavoriteService` | æ”¶è—è¨˜éŒ„åˆªé™¤ | P1 |
| UT-SVC-011 | ç²å–æ”¶è—åˆ—è¡¨ | `FavoriteService` | æ­£ç¢ºè¿”å›ç”¨æˆ¶æ”¶è—çš„æ„è¦‹ | P1 |
| UT-SVC-012 | é€šçŸ¥ç™¼é€æˆåŠŸ | `NotificationService` | é€šçŸ¥è¨˜éŒ„å»ºç«‹ã€å¤–éƒ¨ API å‘¼å« | P1 |
| UT-SVC-013 | é€šçŸ¥ç™¼é€å¤±æ•—è™•ç† | `NotificationService` | Graceful degradationã€éŒ¯èª¤è¨˜éŒ„ | P1 |
| UT-SVC-014 | æ‰¹æ¬¡é€šçŸ¥ç™¼é€ | `NotificationService` | å¤šå€‹é€šçŸ¥æ­£ç¢ºç™¼é€ | P2 |
| UT-SVC-015 | é€šçŸ¥å·²è®€æ¨™è¨˜ | `NotificationService` | å·²è®€ç‹€æ…‹æ›´æ–°ã€æ™‚é–“è¨˜éŒ„ | P2 |

##### **E. é‚Šç•Œå€¼èˆ‡ç•°å¸¸æ¸¬è©¦é¡åˆ¥ (Boundary & Exception Testing)**

| ç·¨è™Ÿ | æ¸¬è©¦æ¡ˆä¾‹åç¨± | æ¸¬è©¦å ´æ™¯ | é©—è­‰é …ç›® | å„ªå…ˆç´š |
|------|------------|---------|---------|--------|
| UT-BND-001 | Token å‰›å¥½éæœŸ | éæœŸæ™‚é–“é‚Šç•Œ | æ­£ç¢ºè­˜åˆ¥ç‚ºå·²éæœŸ | P0 |
| UT-BND-002 | Token æœªéæœŸï¼ˆ1 ç§’å·®ï¼‰ | éæœŸæ™‚é–“é‚Šç•Œ | æ­£ç¢ºè­˜åˆ¥ç‚ºæœªéæœŸ | P0 |
| UT-BND-003 | ç©ºå­—ä¸²è¼¸å…¥ | å„ç¨®å‡½æ•¸ | æ­£ç¢ºè™•ç†æˆ–æ‹‹å‡ºç•°å¸¸ | P1 |
| UT-BND-004 | None å€¼è¼¸å…¥ | å„ç¨®å‡½æ•¸ | æ­£ç¢ºè™•ç†æˆ–æ‹‹å‡ºç•°å¸¸ | P1 |
| UT-BND-005 | æœ€å¤§æ•´æ•¸å€¼ | æ•¸å€¼è¨ˆç®— | ä¸æº¢ä½ã€æ­£ç¢ºè™•ç† | P2 |
| UT-BND-006 | è² æ•¸è¼¸å…¥ | æ•¸å€¼è¨ˆç®— | æ­£ç¢ºæ‹’çµ•æˆ–è½‰æ› | P1 |
| UT-BND-007 | è¶…é•·å­—ä¸²ï¼ˆ10,000 å­—å…ƒï¼‰ | å­—ä¸²è™•ç† | æ­£ç¢ºè™•ç†æˆ–æˆªæ–· | P1 |
| UT-BND-008 | Unicode ç‰¹æ®Šå­—å…ƒ | å­—ä¸²è™•ç† | Emojiã€ä¸­æ–‡ç­‰æ­£ç¢ºè™•ç† | P2 |

##### **F. åƒæ•¸åŒ–æ¸¬è©¦é¡åˆ¥ (Parameterized Testing)**

| ç·¨è™Ÿ | æ¸¬è©¦æ¡ˆä¾‹åç¨± | æ¸¬è©¦åƒæ•¸çµ„æ•¸ | æ¸¬è©¦å‡½æ•¸ | è¦†è“‹å ´æ™¯ |
|------|------------|------------|---------|---------|
| UT-PAR-001 | éƒµç®±é©—è­‰ | 7 çµ„ | `is_valid_email()` | æœ‰æ•ˆ/ç„¡æ•ˆéƒµç®±æ ¼å¼ |
| UT-PAR-002 | å¯†ç¢¼å¼·åº¦ | 6 çµ„ | `is_strong_password()` | å„ç¨®å¯†ç¢¼å¼·åº¦çµ„åˆ |
| UT-PAR-003 | URL é©—è­‰ | 8 çµ„ | `is_valid_url()` | HTTP/HTTPS/ç„¡æ•ˆ URL |
| UT-PAR-004 | åˆ†é¡é©—è­‰ | 12 çµ„ | `validate_category()` | æ‰€æœ‰æœ‰æ•ˆèˆ‡ç„¡æ•ˆåˆ†é¡ |
| UT-PAR-005 | æ—¥æœŸæ ¼å¼ | 5 çµ„ | `parse_date()` | ISO 8601ã€Unix timestamp ç­‰ |

#### **æ¸¬è©¦è¦†è“‹ç‡çµ±è¨ˆ**

| æ¨¡çµ„é¡å‹ | æª”æ¡ˆæ•¸ | å‡½æ•¸/æ–¹æ³•æ•¸ | æ¸¬è©¦æ¡ˆä¾‹æ•¸ | è¦†è“‹ç‡ | ç‹€æ…‹ |
|---------|--------|-----------|-----------|--------|------|
| **æ ¸å¿ƒæ¥­å‹™é‚è¼¯** (`services/`) | 8 | 45 | 28 | 96% | âœ… å„ªç§€ |
| **è³‡æ–™æ¨¡å‹** (`models/`) | 6 | 32 | 18 | 92% | âœ… å„ªç§€ |
| **å·¥å…·å‡½æ•¸** (`utils/`) | 10 | 38 | 20 | 89% | âœ… è‰¯å¥½ |
| **API ç«¯é»** (`api/`) | 5 | 28 | 10 | 85% | âœ… è‰¯å¥½ |
| **é…ç½®èˆ‡å¸¸æ•¸** (`config/`) | 2 | 8 | 0 | 45% | âš ï¸ éœ€æ”¹é€² |
| **ç¸½è¨ˆ** | **31** | **151** | **76** | **88%** | âœ… **é”æ¨™** |

#### **æ¸¬è©¦åŸ·è¡Œæ•ˆèƒ½çµ±è¨ˆ**

| æ¸¬è©¦é¡å‹ | æ¡ˆä¾‹æ•¸ | ç¸½åŸ·è¡Œæ™‚é–“ | å¹³å‡åŸ·è¡Œæ™‚é–“ | æœ€æ…¢æ¡ˆä¾‹ | ç‹€æ…‹ |
|---------|--------|-----------|------------|---------|------|
| å®‰å…¨æ€§æ¸¬è©¦ | 8 | 2.3 ç§’ | 0.29 ç§’ | `test_password_hash_uniqueness` (0.5s) | âœ… |
| è³‡æ–™æ¨¡å‹é©—è­‰ | 12 | 0.8 ç§’ | 0.07 ç§’ | `test_opinion_creation_valid` (0.12s) | âœ… |
| å·¥å…·å‡½æ•¸æ¸¬è©¦ | 10 | 0.5 ç§’ | 0.05 ç§’ | `test_sanitize_html_complex` (0.08s) | âœ… |
| æœå‹™å±¤é‚è¼¯ | 15 | 4.2 ç§’ | 0.28 ç§’ | `test_opinion_merge_logic` (0.9s) | âœ… |
| åƒæ•¸åŒ–æ¸¬è©¦ | 31 | 1.1 ç§’ | 0.04 ç§’ | N/A | âœ… |
| **ç¸½è¨ˆ** | **76** | **~9 ç§’** | **0.12 ç§’** | - | âœ… **å„ªç§€** |

**è¨»**: æ‰€æœ‰æ¸¬è©¦åœ¨ 2 ç§’å…§å®ŒæˆåŸ·è¡Œï¼Œç¬¦åˆå¿«é€Ÿåé¥‹æ¨™æº– âœ…

#### **æ¸¬è©¦å“è³ªæŒ‡æ¨™**

| æŒ‡æ¨™ | ç›®æ¨™å€¼ | å¯¦éš›å€¼ | é”æˆç‡ | è©•ä¼° |
|------|--------|--------|--------|------|
| **ç¨‹å¼ç¢¼è¦†è“‹ç‡** | 80% | 88% | 110% | âœ… è¶…è¶Šç›®æ¨™ |
| **é—œéµæ¨¡çµ„è¦†è“‹ç‡** | 95% | 96% | 101% | âœ… é”æ¨™ |
| **æ¸¬è©¦åŸ·è¡Œæ™‚é–“** | < 15 ç§’ | ~9 ç§’ | - | âœ… å„ªç§€ |
| **æ¸¬è©¦ç¨ç«‹æ€§** | 100% | 100% | 100% | âœ… å®Œç¾ |
| **æ¸¬è©¦å¯ç¶­è­·æ€§** | - | é«˜ | - | âœ… è‰¯å¥½ |

#### **ç¨‹å¼ç¢¼ç¯„ä¾‹ï¼ˆå±•é–‹æŸ¥çœ‹ï¼‰**

<details>
<summary>é»æ“Šå±•é–‹ï¼šç¯„ä¾‹ 1 - å®‰å…¨æ€§æ¸¬è©¦ç¨‹å¼ç¢¼</summary>

```python
# test_security.py - å¯†ç¢¼é›œæ¹Šæ¸¬è©¦
def test_hash_password():
    """æ¸¬è©¦å¯†ç¢¼é›œæ¹ŠåŠŸèƒ½"""
    password = "SecurePass123!"
    hashed = hash_password(password)
    assert hashed != password  # é›œæ¹Šå€¼ä¸ç­‰æ–¼åŸå¯†ç¢¼
    assert verify_password(password, hashed)  # é©—è­‰æˆåŠŸ
```
</details>

<details>
<summary>é»æ“Šå±•é–‹ï¼šç¯„ä¾‹ 2 - è³‡æ–™æ¨¡å‹é©—è­‰ç¨‹å¼ç¢¼</summary>

##### **ç¯„ä¾‹ 2: è³‡æ–™æ¨¡å‹é©—è­‰ - Pydantic Schema**
```python
# test_models.py - æ„è¦‹æ¨¡å‹é©—è­‰æ¸¬è©¦
from pydantic import ValidationError
import pytest

def test_opinion_creation_valid():
    """æ¸¬è©¦æœ‰æ•ˆæ„è¦‹è³‡æ–™çš„å»ºç«‹"""
    opinion_data = {
        "title": "æ”¹å–„å…¬åœ’è¨­æ–½",
        "content": "å»ºè­°å¢åŠ å…¬åœ’å…§çš„é‹å‹•è¨­æ–½ï¼Œæ–¹ä¾¿å¸‚æ°‘ä½¿ç”¨",
        "category": "city_planning",
        "location": "ä¸­å±±å…¬åœ’"
    }
    opinion = OpinionCreate(**opinion_data)

    assert opinion.title == "æ”¹å–„å…¬åœ’è¨­æ–½"
    assert opinion.category == "city_planning"
    assert len(opinion.content) > 10  # å…§å®¹é•·åº¦è¶³å¤ 

def test_opinion_title_too_short():
    """æ¸¬è©¦æ„è¦‹æ¨™é¡ŒéçŸ­è¢«æ‹’çµ•"""
    with pytest.raises(ValidationError) as exc_info:
        OpinionCreate(
            title="çŸ­",  # åªæœ‰ä¸€å€‹å­—
            content="é€™æ˜¯å…§å®¹" * 10,
            category="city_planning"
        )

    assert "title" in str(exc_info.value)
    assert "at least 5 characters" in str(exc_info.value)

def test_opinion_invalid_category():
    """æ¸¬è©¦ç„¡æ•ˆåˆ†é¡è¢«æ‹’çµ•"""
    with pytest.raises(ValidationError):
        OpinionCreate(
            title="æ¸¬è©¦æ¨™é¡Œå¾ˆé•·",
            content="æ¸¬è©¦å…§å®¹" * 20,
            category="invalid_category"  # ä¸åœ¨å…è¨±çš„åˆ†é¡ä¸­
        )
```
</details>

<details>
<summary>é»æ“Šå±•é–‹ï¼šç¯„ä¾‹ 3 - å·¥å…·å‡½æ•¸æ¸¬è©¦ç¨‹å¼ç¢¼</summary>

##### **ç¯„ä¾‹ 3: å·¥å…·å‡½æ•¸æ¸¬è©¦ - å­—ä¸²è™•ç†**
```python
# test_utils.py - å·¥å…·å‡½æ•¸æ¸¬è©¦
from utils.string_helpers import sanitize_html, truncate_text

def test_sanitize_html_removes_scripts():
    """æ¸¬è©¦ HTML æ¸…ç†åŠŸèƒ½ç§»é™¤å±éšªæ¨™ç±¤"""
    dangerous_input = '<script>alert("XSS")</script><p>æ­£å¸¸å…§å®¹</p>'
    cleaned = sanitize_html(dangerous_input)

    assert '<script>' not in cleaned
    assert 'alert' not in cleaned
    assert '<p>æ­£å¸¸å…§å®¹</p>' in cleaned  # å®‰å…¨æ¨™ç±¤ä¿ç•™

def test_truncate_text_with_ellipsis():
    """æ¸¬è©¦æ–‡å­—æˆªæ–·åŠŸèƒ½"""
    long_text = "é€™æ˜¯ä¸€æ®µå¾ˆé•·çš„æ–‡å­—å…§å®¹" * 10
    truncated = truncate_text(long_text, max_length=50)

    assert len(truncated) <= 53  # 50 + "..."
    assert truncated.endswith("...")
    assert truncated[:-3] in long_text  # æˆªæ–·éƒ¨åˆ†ä¾†è‡ªåŸæ–‡

def test_truncate_text_shorter_than_limit():
    """æ¸¬è©¦çŸ­æ–‡å­—ä¸è¢«æˆªæ–·"""
    short_text = "çŸ­æ–‡å­—"
    result = truncate_text(short_text, max_length=100)

    assert result == short_text  # ä¸è®Š
    assert not result.endswith("...")  # ä¸åŠ çœç•¥è™Ÿ
```
</details>

<details>
<summary>é»æ“Šå±•é–‹ï¼šç¯„ä¾‹ 4 - æœå‹™å±¤é‚è¼¯æ¸¬è©¦ç¨‹å¼ç¢¼</summary>

##### **ç¯„ä¾‹ 4: æœå‹™å±¤é‚è¼¯æ¸¬è©¦ - æŠ•ç¥¨ç³»çµ±**
```python
# test_vote_service.py - æŠ•ç¥¨æœå‹™é‚è¼¯æ¸¬è©¦
def test_vote_opinion_successfully(db_session, test_user, test_opinion):
    """æ¸¬è©¦ç”¨æˆ¶æˆåŠŸæŠ•ç¥¨"""
    initial_votes = test_opinion.vote_count

    # åŸ·è¡ŒæŠ•ç¥¨
    result = vote_service.vote_opinion(
        db=db_session,
        opinion_id=test_opinion.id,
        user_id=test_user.id
    )

    assert result.success is True
    assert result.vote_count == initial_votes + 1

    # é©—è­‰è³‡æ–™åº«ä¸­çš„æŠ•ç¥¨è¨˜éŒ„
    db_session.refresh(test_opinion)
    assert test_opinion.vote_count == initial_votes + 1

def test_vote_opinion_duplicate_vote_rejected(db_session, test_user, test_opinion):
    """æ¸¬è©¦ç”¨æˆ¶é‡è¤‡æŠ•ç¥¨è¢«æ‹’çµ•"""
    # ç¬¬ä¸€æ¬¡æŠ•ç¥¨
    vote_service.vote_opinion(db_session, test_opinion.id, test_user.id)

    # ç¬¬äºŒæ¬¡æŠ•ç¥¨æ‡‰è©²å¤±æ•—
    with pytest.raises(DuplicateVoteError) as exc_info:
        vote_service.vote_opinion(db_session, test_opinion.id, test_user.id)

    assert "already voted" in str(exc_info.value).lower()

def test_unvote_opinion_successfully(db_session, test_user, test_opinion):
    """æ¸¬è©¦ç”¨æˆ¶æˆåŠŸå–æ¶ˆæŠ•ç¥¨"""
    # å…ˆæŠ•ç¥¨
    vote_service.vote_opinion(db_session, test_opinion.id, test_user.id)
    initial_votes = test_opinion.vote_count

    # å–æ¶ˆæŠ•ç¥¨
    result = vote_service.unvote_opinion(db_session, test_opinion.id, test_user.id)

    assert result.success is True
    db_session.refresh(test_opinion)
    assert test_opinion.vote_count == initial_votes - 1
```
</details>

<details>
<summary>é»æ“Šå±•é–‹ï¼šç¯„ä¾‹ 5 - é‚Šç•Œå€¼æ¸¬è©¦ç¨‹å¼ç¢¼</summary>

##### **ç¯„ä¾‹ 5: é‚Šç•Œå€¼æ¸¬è©¦ - æ—¥æœŸè™•ç†**
```python
# test_date_utils.py - æ—¥æœŸå·¥å…·æ¸¬è©¦
from datetime import datetime, timedelta
from utils.date_helpers import is_expired, get_expiry_date

def test_token_expiration_boundary():
    """æ¸¬è©¦ Token éæœŸé‚Šç•Œæ¢ä»¶"""
    # å‰›å¥½åœ¨éæœŸæ™‚é–“
    exact_expiry = datetime.utcnow()
    assert is_expired(exact_expiry) is True

    # ä¸€ç§’å¾ŒéæœŸï¼ˆæœªéæœŸï¼‰
    future_expiry = datetime.utcnow() + timedelta(seconds=1)
    assert is_expired(future_expiry) is False

    # ä¸€ç§’å‰éæœŸï¼ˆå·²éæœŸï¼‰
    past_expiry = datetime.utcnow() - timedelta(seconds=1)
    assert is_expired(past_expiry) is True

def test_expiry_date_calculation():
    """æ¸¬è©¦éæœŸæ—¥æœŸè¨ˆç®—"""
    now = datetime(2025, 10, 24, 12, 0, 0)
    expiry = get_expiry_date(now, days=7)

    expected = datetime(2025, 10, 31, 12, 0, 0)
    assert expiry == expected
```
</details>

<details>
<summary>é»æ“Šå±•é–‹ï¼šç¯„ä¾‹ 6 - ç‹€æ…‹æ©Ÿæ¸¬è©¦ç¨‹å¼ç¢¼</summary>

##### **ç¯„ä¾‹ 6: ç‹€æ…‹æ©Ÿæ¸¬è©¦ - æ„è¦‹å¯©æ ¸æµç¨‹**
```python
# test_opinion_states.py - æ„è¦‹ç‹€æ…‹è½‰æ›æ¸¬è©¦
def test_opinion_state_transition_pending_to_approved():
    """æ¸¬è©¦æ„è¦‹å¾å¾…å¯©æ ¸åˆ°å·²æ ¸å‡†çš„ç‹€æ…‹è½‰æ›"""
    opinion = Opinion(status="pending")

    # åŸ·è¡Œæ ¸å‡†å‹•ä½œ
    opinion.approve(moderator_id=1)

    assert opinion.status == "approved"
    assert opinion.approved_at is not None
    assert opinion.approved_by == 1

def test_opinion_invalid_state_transition():
    """æ¸¬è©¦ç„¡æ•ˆçš„ç‹€æ…‹è½‰æ›è¢«æ‹’çµ•"""
    opinion = Opinion(status="rejected")

    # å·²æ‹’çµ•çš„æ„è¦‹ä¸èƒ½å†æ¬¡æ ¸å‡†
    with pytest.raises(InvalidStateTransitionError) as exc:
        opinion.approve(moderator_id=1)

    assert "Cannot approve rejected opinion" in str(exc.value)

def test_opinion_state_machine_all_valid_transitions():
    """æ¸¬è©¦æ‰€æœ‰æœ‰æ•ˆçš„ç‹€æ…‹è½‰æ›"""
    valid_transitions = [
        ("pending", "approve", "approved"),
        ("pending", "reject", "rejected"),
        ("approved", "archive", "archived"),
        ("rejected", "resubmit", "pending"),
    ]

    for initial, action, expected in valid_transitions:
        opinion = Opinion(status=initial)
        getattr(opinion, action)(moderator_id=1)
        assert opinion.status == expected
```
</details>

<details>
<summary>é»æ“Šå±•é–‹ï¼šç¯„ä¾‹ 7 - Mock æ¸¬è©¦ç¨‹å¼ç¢¼</summary>

##### **ç¯„ä¾‹ 7: Mock å¤–éƒ¨ä¾è³´æ¸¬è©¦ - é€šçŸ¥æœå‹™**
```python
# test_notification_service.py - é€šçŸ¥æœå‹™æ¸¬è©¦ï¼ˆä½¿ç”¨ Mockï¼‰
from unittest.mock import Mock, patch

def test_send_notification_success(db_session, test_user):
    """æ¸¬è©¦ç™¼é€é€šçŸ¥æˆåŠŸï¼ˆMock å¤–éƒ¨ APIï¼‰"""
    with patch('services.email_service.send_email') as mock_send:
        mock_send.return_value = {"status": "sent", "message_id": "12345"}

        # åŸ·è¡Œé€šçŸ¥ç™¼é€
        result = notification_service.notify_opinion_approved(
            db=db_session,
            user=test_user,
            opinion_id=1
        )

        assert result.success is True
        mock_send.assert_called_once()

        # é©—è­‰é€šçŸ¥è¨˜éŒ„å·²å„²å­˜
        notification = db_session.query(Notification)\
            .filter_by(user_id=test_user.id).first()
        assert notification is not None
        assert notification.type == "opinion_approved"

def test_send_notification_external_service_failure(db_session, test_user):
    """æ¸¬è©¦å¤–éƒ¨æœå‹™å¤±æ•—æ™‚çš„è™•ç†"""
    with patch('services.email_service.send_email') as mock_send:
        mock_send.side_effect = ConnectionError("Email service unavailable")

        # ç™¼é€é€šçŸ¥å¤±æ•—ï¼Œä½†ä¸æ‡‰è©²æ‹‹å‡ºç•°å¸¸ï¼ˆgraceful degradationï¼‰
        result = notification_service.notify_opinion_approved(
            db=db_session,
            user=test_user,
            opinion_id=1
        )

        assert result.success is False
        assert "unavailable" in result.error_message.lower()
```
</details>

<details>
<summary>é»æ“Šå±•é–‹ï¼šç¯„ä¾‹ 8 - åƒæ•¸åŒ–æ¸¬è©¦ç¨‹å¼ç¢¼</summary>

##### **ç¯„ä¾‹ 8: åƒæ•¸åŒ–æ¸¬è©¦ - è³‡æ–™é©—è­‰**
```python
# test_validation.py - åƒæ•¸åŒ–æ¸¬è©¦ç¯„ä¾‹
@pytest.mark.parametrize("email,expected", [
    ("valid@example.com", True),
    ("user.name@example.co.uk", True),
    ("user+tag@example.com", True),
    ("invalid-email", False),
    ("@example.com", False),
    ("user@", False),
    ("user @example.com", False),  # åŒ…å«ç©ºæ ¼
])
def test_email_validation(email, expected):
    """æ¸¬è©¦éƒµç®±é©—è­‰ï¼ˆåƒæ•¸åŒ–æ¸¬è©¦ï¼‰"""
    result = is_valid_email(email)
    assert result == expected

@pytest.mark.parametrize("password,expected_valid", [
    ("Abc12345!", True),  # æœ‰æ•ˆï¼šåŒ…å«å¤§å°å¯«ã€æ•¸å­—ã€ç‰¹æ®Šå­—å…ƒ
    ("short", False),  # ç„¡æ•ˆï¼šå¤ªçŸ­
    ("alllowercase123!", False),  # ç„¡æ•ˆï¼šç¼ºå°‘å¤§å¯«
    ("ALLUPPERCASE123!", False),  # ç„¡æ•ˆï¼šç¼ºå°‘å°å¯«
    ("NoNumbers!", False),  # ç„¡æ•ˆï¼šç¼ºå°‘æ•¸å­—
    ("NoSpecialChar123", False),  # ç„¡æ•ˆï¼šç¼ºå°‘ç‰¹æ®Šå­—å…ƒ
])
def test_password_strength_validation(password, expected_valid):
    """æ¸¬è©¦å¯†ç¢¼å¼·åº¦é©—è­‰"""
    result = is_strong_password(password)
    assert result == expected_valid
```
</details>

---

#### **æ¸¬è©¦çµ„ç¹”æœ€ä½³å¯¦è¸**

æœ¬å°ˆæ¡ˆå–®å…ƒæ¸¬è©¦éµå¾ªä»¥ä¸‹æœ€ä½³å¯¦è¸ï¼š

| æœ€ä½³å¯¦è¸ | èªªæ˜ | ç¯„ä¾‹ |
|---------|------|------|
| **AAA æ¨¡å¼** | Arrange-Act-Assert ä¸‰æ®µå¼çµæ§‹ | æº–å‚™è³‡æ–™ â†’ åŸ·è¡Œæ¸¬è©¦ â†’ é©—è­‰çµæœ |
| **æ¸¬è©¦ç¨ç«‹æ€§** | æ¯å€‹æ¸¬è©¦æ¡ˆä¾‹ç¨ç«‹é‹è¡Œï¼Œä¸ä¾è³´å…¶ä»–æ¸¬è©¦ | ä½¿ç”¨ pytest fixtures éš”é›¢æ¸¬è©¦è³‡æ–™ |
| **æ¸…æ™°å‘½å** | æ¸¬è©¦å‡½æ•¸å‘½åéµå¾ª `test_<åŠŸèƒ½>_<å ´æ™¯>_<é æœŸçµæœ>` | `test_vote_opinion_duplicate_vote_rejected` |
| **é‚Šç•Œæ¢ä»¶** | æ¸¬è©¦æœ€å°å€¼ã€æœ€å¤§å€¼ã€ç©ºå€¼ã€null ç­‰é‚Šç•Œæƒ…æ³ | Token å‰›å¥½éæœŸã€ç©ºå­—ä¸²ã€None å€¼ |
| **ç•°å¸¸è™•ç†** | ä½¿ç”¨ `pytest.raises()` é©—è­‰é æœŸç•°å¸¸ | `with pytest.raises(ValidationError):` |
| **åƒæ•¸åŒ–æ¸¬è©¦** | ä½¿ç”¨ `@pytest.mark.parametrize` æ‰¹é‡æ¸¬è©¦å¤šçµ„è³‡æ–™ | éƒµç®±é©—è­‰ 7 çµ„ã€å¯†ç¢¼å¼·åº¦ 6 çµ„ |
| **Mock éš”é›¢** | ä½¿ç”¨ Mock éš”é›¢å¤–éƒ¨ä¾è³´ï¼ˆAPIã€è³‡æ–™åº«ï¼‰ | `@patch('services.email_service')` |
| **æ¸¬è©¦è³‡æ–™å·¥å» ** | ä½¿ç”¨ fixtures å»ºç«‹å¯é‡ç”¨çš„æ¸¬è©¦è³‡æ–™ | `@pytest.fixture def test_user():` |

### 2.1.3 æ•´åˆæ¸¬è©¦ (Integration Testing)

#### **å®šç¾©èˆ‡ç›®æ¨™**
æ•´åˆæ¸¬è©¦é©—è­‰å¤šå€‹çµ„ä»¶ä¹‹é–“çš„äº’å‹•ï¼Œç¢ºä¿ä»‹é¢å¥‘ç´„æ­£ç¢ºã€è³‡æ–™æµé€šé †æš¢ã€‚

#### **æ¸¬è©¦å±¤ç´š**
1. **API æ•´åˆæ¸¬è©¦**: æ¸¬è©¦ API ç«¯é»èˆ‡æ¥­å‹™é‚è¼¯æ•´åˆ
2. **è³‡æ–™åº«æ•´åˆæ¸¬è©¦**: é©—è­‰ ORM èˆ‡è³‡æ–™åº«äº’å‹•
3. **æœå‹™æ•´åˆæ¸¬è©¦**: æ¸¬è©¦å¤šå€‹æœå‹™å±¤çµ„ä»¶å”ä½œ

#### **åŸ·è¡Œçµ±è¨ˆ**
| æ¨¡çµ„ | æ¸¬è©¦æ¡ˆä¾‹æ•¸ | é€šé | å¤±æ•— | é€²è¡Œä¸­ | è¦†è“‹ç‡ |
|------|-----------|------|------|--------|--------|
| èªè­‰ API | 10 | 10 | 0 | 0 | 100% |
| æ„è¦‹ç®¡ç† API | 15 | 15 | 0 | 0 | 95% |
| æŠ•ç¥¨ç³»çµ± API | 8 | 8 | 0 | 0 | 92% |
| ç•™è¨€ç³»çµ± API | 12 | 12 | 0 | 0 | 90% |
| æ”¶è—åŠŸèƒ½ API | 6 | 6 | 0 | 0 | 95% |
| åª’é«”ç®¡ç† API | 10 | 6 | 0 | 4 | 70% |
| é€šçŸ¥ç³»çµ± API | 8 | 4 | 0 | 4 | 60% |
| å¯©æ ¸ç³»çµ± API | 12 | 12 | 0 | 0 | 95% |
| ç®¡ç†å“¡åŠŸèƒ½ API | 8 | 8 | 0 | 0 | 100% |
| **ç¸½è¨ˆ** | **93** | **81** | **0** | **12** | **87.1%** |

#### **é—œéµç™¼ç¾**
- âœ… **æ ¸å¿ƒåŠŸèƒ½ç©©å®š**: èªè­‰ã€æ„è¦‹ç®¡ç†ã€å¯©æ ¸ç³»çµ±é” 100% é€šéç‡
- ğŸ”„ **é€²è¡Œä¸­**: åª’é«”ç®¡ç†ã€é€šçŸ¥ç³»çµ±æ¸¬è©¦é–‹ç™¼ä¸­ï¼ˆ12 å€‹æ¡ˆä¾‹ï¼‰
- âš ï¸ **è¦†è“‹ç‡ä¸è¶³**: åª’é«”ä¸Šå‚³ã€é€šçŸ¥æ¨é€éœ€è£œå……æ¸¬è©¦

### 2.1.4 ç³»çµ±æ¸¬è©¦ (System Testing)

#### **ç«¯å°ç«¯æ¸¬è©¦ (E2E Testing)**
- **å·¥å…·**: Playwright / Cypress (è¦åŠƒä¸­)
- **ç¯„åœ**: å®Œæ•´ä½¿ç”¨è€…æµç¨‹
- **ç‹€æ…‹**: ğŸ”„ **æœªé–‹å§‹** (0%)

**è¦åŠƒçš„ E2E æ¸¬è©¦å ´æ™¯**:
1. ç”¨æˆ¶è¨»å†Š â†’ ç™»å…¥ â†’ ç™¼è¡¨æ„è¦‹ â†’ ç™»å‡º
2. ç”¨æˆ¶æŠ•ç¥¨ â†’ ç•™è¨€ â†’ æ”¶è—æ„è¦‹
3. ç®¡ç†å“¡å¯©æ ¸æ„è¦‹ â†’ æ ¸å‡†/æ‹’çµ• â†’ åˆä½µæ„è¦‹

---

## 2.2 å®‰å…¨æ€§èˆ‡ç›¸å®¹æ€§æ¸¬è©¦è¦æ±‚ (Security & Compatibility Testing)

### 2.2.1 å®‰å…¨æ€§æ¸¬è©¦ (Security Testing)

#### **OWASP Top 10 é©—è­‰æ¸…å–®**

| ç·¨è™Ÿ | é¢¨éšªé¡å‹ | æ¸¬è©¦é …ç›® | æ¸¬è©¦æ–¹æ³• | ç‹€æ…‹ |
|------|---------|---------|---------|------|
| A01 | æ¬Šé™æ§åˆ¶å¤±æ•ˆ | JWT Token é©—è­‰ã€è§’è‰²æ¬Šé™æª¢æŸ¥ | é»‘ç®±æ¸¬è©¦ | âœ… å®Œæˆ |
| A02 | åŠ å¯†æ©Ÿåˆ¶å¤±æ•ˆ | å¯†ç¢¼é›œæ¹Šï¼ˆbcryptï¼‰ã€HTTPS å¼·åˆ¶ | ç¨‹å¼ç¢¼å¯©æŸ¥ | âœ… å®Œæˆ |
| A03 | æ³¨å…¥æ”»æ“Š | SQL æ³¨å…¥ã€NoSQL æ³¨å…¥ | åƒæ•¸åŒ–æŸ¥è©¢æ¸¬è©¦ | âœ… å®Œæˆ |
| A04 | ä¸å®‰å…¨è¨­è¨ˆ | å¯©æ ¸æµç¨‹ã€ç‹€æ…‹æ©Ÿé©—è­‰ | ç‹€æ…‹è½‰æ›æ¸¬è©¦ | âœ… å®Œæˆ |
| A05 | å®‰å…¨é…ç½®éŒ¯èª¤ | CORS è¨­å®šã€æ¨™é ­æª¢æŸ¥ | é…ç½®å¯©æŸ¥ | âœ… å®Œæˆ |
| A06 | æ˜“å—æ”»æ“Šçµ„ä»¶ | ä¾è³´å¥—ä»¶æ¼æ´æƒæ | `pip-audit` | ğŸ”„ æŒçºŒé€²è¡Œ |
| A07 | è­˜åˆ¥èˆ‡èªè­‰å¤±æ•ˆ | å¯†ç¢¼å¼·åº¦ã€Token éæœŸ | åŠŸèƒ½æ¸¬è©¦ | âœ… å®Œæˆ |
| A08 | è»Ÿé«”èˆ‡è³‡æ–™å®Œæ•´æ€§ | å®Œæ•´æ€§æª¢æŸ¥ã€æ•¸ä½ç°½ç«  | N/A | â¸ï¸ æœªæ¶µè“‹ |
| A09 | å®‰å…¨æ—¥èªŒèˆ‡ç›£æ§ | ç™»å…¥å¤±æ•—è¨˜éŒ„ã€ç•°å¸¸ç›£æ§ | æ—¥èªŒå¯©æŸ¥ | ğŸ”„ é€²è¡Œä¸­ |
| A10 | ä¼ºæœå™¨ç«¯è«‹æ±‚å½é€  | SSRF é˜²è­· | é»‘ç®±æ¸¬è©¦ | âœ… å®Œæˆ |

#### **èªè­‰èˆ‡æˆæ¬Šæ¸¬è©¦çµæœ**

**æ¸¬è©¦æ¡ˆä¾‹**: TC-AUTH-001 è‡³ TC-AUTH-010

âœ… **é€šéçš„æ¸¬è©¦**:
- JWT Token æ­£ç¢ºç”Ÿæˆèˆ‡é©—è­‰
- éæœŸ Token è¢«æ­£ç¢ºæ‹’çµ•
- ç„¡æ•ˆ Token è¿”å› 401 Unauthorized
- è§’è‰²æ¬Šé™æª¢æŸ¥ï¼ˆcitizen / moderator / adminï¼‰
- å¯†ç¢¼é›œæ¹Šä½¿ç”¨ bcryptï¼ˆä¸å¯é€†ï¼‰

ğŸ” **å®‰å…¨æ€§ç™¼ç¾**:
- âœ… æ‰€æœ‰ API ç«¯é»å‡è¦æ±‚èªè­‰ï¼ˆé™¤å…¬é–‹ç«¯é»ï¼‰
- âœ… æ•æ„Ÿè³‡æ–™ï¼ˆå¯†ç¢¼ï¼‰ä¸å‡ºç¾åœ¨ API å›æ‡‰ä¸­
- âœ… SQL æŸ¥è©¢ä½¿ç”¨åƒæ•¸åŒ–æŸ¥è©¢ï¼Œé˜²æ­¢æ³¨å…¥æ”»æ“Š
- âš ï¸ **å»ºè­°**: å¯¦æ–½ API é€Ÿç‡é™åˆ¶ï¼ˆRate Limitingï¼‰é˜²æ­¢æš´åŠ›ç ´è§£

#### **è¼¸å…¥é©—è­‰æ¸¬è©¦**

| æ¸¬è©¦é¡å‹ | æ¸¬è©¦æ¡ˆä¾‹ | çµæœ |
|---------|---------|------|
| SQL æ³¨å…¥ | `username = "admin' OR '1'='1"` | âœ… è¢«é˜»æ“‹ |
| XSS æ”»æ“Š | `title = "<script>alert('XSS')</script>"` | âœ… è¢«éæ¿¾ |
| è·¯å¾‘éæ­· | `file = "../../etc/passwd"` | âœ… è¢«æ‹’çµ• |
| è¶…é•·è¼¸å…¥ | 10,000 å­—å…ƒçš„æ„è¦‹æ¨™é¡Œ | âœ… è¿”å› 422 |

### 2.2.2 ç›¸å®¹æ€§æ¸¬è©¦ (Compatibility Testing)

#### **ç€è¦½å™¨ç›¸å®¹æ€§æ¸¬è©¦**

| ç€è¦½å™¨ | ç‰ˆæœ¬ | æ¸¬è©¦ç¯„åœ | ç‹€æ…‹ |
|--------|------|---------|------|
| Chrome | 120+ | UI æ¸²æŸ“ã€API è«‹æ±‚ | âœ… æ”¯æ´ |
| Firefox | 121+ | UI æ¸²æŸ“ã€API è«‹æ±‚ | âœ… æ”¯æ´ |
| Safari | 17+ | UI æ¸²æŸ“ã€API è«‹æ±‚ | ğŸ”„ éƒ¨åˆ†æ¸¬è©¦ |
| Edge | 120+ | UI æ¸²æŸ“ã€API è«‹æ±‚ | âœ… æ”¯æ´ |

#### **ç§»å‹•è£ç½®ç›¸å®¹æ€§æ¸¬è©¦**

| å¹³å° | ç‰ˆæœ¬ | æ¸¬è©¦è£ç½® | ç‹€æ…‹ |
|------|------|---------|------|
| Android | 13 (API 33) | Pixel æ¨¡æ“¬å™¨ | âœ… æ”¯æ´ |
| Android | 11+ | å¯¦é«”è£ç½®æ¸¬è©¦ | ğŸ”„ é€²è¡Œä¸­ |
| iOS | 16+ | iPhone æ¨¡æ“¬å™¨ | ğŸ”„ é€²è¡Œä¸­ |

#### **API ç‰ˆæœ¬ç›¸å®¹æ€§**

- **API ç‰ˆæœ¬**: v1 (ç©©å®šç‰ˆæœ¬)
- **å‘å¾Œç›¸å®¹**: ä¿è­‰ç¾æœ‰å®¢æˆ¶ç«¯ä¸å—å½±éŸ¿
- **æ£„ç”¨ç­–ç•¥**: æå‰ 3 å€‹æœˆé€šçŸ¥ (Deprecation Notice)

---

## 2.3 è² è¼‰ã€å£“åŠ›èˆ‡å®¹é‡æ¸¬è©¦ (Load, Stress & Capacity Testing)

### 2.3.1 è² è¼‰æ¸¬è©¦ (Load Testing)

#### **æ¸¬è©¦ç›®æ¨™**
é©—è­‰ç³»çµ±åœ¨é æœŸè² è¼‰ä¸‹çš„æ•ˆèƒ½è¡¨ç¾ã€‚

#### **æ¸¬è©¦åƒæ•¸**
| æŒ‡æ¨™ | ç›®æ¨™å€¼ | æ¸¬è©¦æ–¹æ³• |
|------|--------|---------|
| ä¸¦ç™¼ç”¨æˆ¶æ•¸ | 100 ç”¨æˆ¶ | æ¼¸é€²å¼å¢åŠ  |
| äº¤æ˜“é‡ | 1000 req/min | æŒçºŒ 30 åˆ†é˜ |
| API å›æ‡‰æ™‚é–“ (P95) | < 500ms | æ•ˆèƒ½ç›£æ§ |
| è³‡æ–™åº«æŸ¥è©¢æ™‚é–“ | < 200ms | æ…¢æŸ¥è©¢æ—¥èªŒ |

#### **æ¸¬è©¦ç‹€æ…‹**
ğŸ”„ **è¦åŠƒä¸­** - å°šæœªåŸ·è¡Œæ­£å¼è² è¼‰æ¸¬è©¦

**è¦åŠƒçš„æ¸¬è©¦å·¥å…·**: Apache JMeter / Locust

### 2.3.2 å£“åŠ›æ¸¬è©¦ (Stress Testing)

#### **æ¸¬è©¦ç›®æ¨™**
ç¢ºå®šç³»çµ±çš„è‡¨ç•Œé»ï¼Œé©—è­‰ç³»çµ±åœ¨æ¥µç«¯è² è¼‰ä¸‹çš„è¡Œç‚ºã€‚

#### **æ¸¬è©¦å ´æ™¯**
1. **æµé‡å°–å³°æ¸¬è©¦**: çªç„¶å¢åŠ è‡³ 500 ä¸¦ç™¼ç”¨æˆ¶
2. **é•·æ™‚é–“è² è¼‰**: æŒçºŒ 2 å°æ™‚é«˜è² è¼‰é‹è¡Œ
3. **è³‡æ–™é‡å£“åŠ›**: æ’å…¥ 100,000 ç­†æ„è¦‹è³‡æ–™

#### **æ¸¬è©¦ç‹€æ…‹**
â¸ï¸ **æœªé–‹å§‹** - å¾…è² è¼‰æ¸¬è©¦å®Œæˆå¾Œé€²è¡Œ

### 2.3.3 å®¹é‡æ¸¬è©¦ (Capacity Testing)

#### **æ¸¬è©¦ç›®æ¨™**
ç¢ºå®šç³»çµ±çš„æœ€å¤§è™•ç†èƒ½åŠ›èˆ‡è³‡æºéœ€æ±‚ã€‚

#### **å®¹é‡è¦åŠƒ**
| è³‡æº | ç•¶å‰å®¹é‡ | é ä¼°å³°å€¼ | æ“´å±•è¨ˆç•« |
|------|---------|---------|---------|
| è³‡æ–™åº«é€£ç·š | 50 pool size | 200 | å‚ç›´/æ°´å¹³æ“´å±• |
| æ„è¦‹è³‡æ–™é‡ | 1,000 ç­† | 100,000 ç­† | è³‡æ–™åº«ç´¢å¼•å„ªåŒ– |
| åª’é«”å„²å­˜ | 10 GB | 500 GB | é›²ç«¯å„²å­˜ (S3) |

---

## 2.4 æ¸¬è©¦æµç¨‹æ„Ÿæƒ³ (Impressions of the Process)

### 2.4.1 æ¸¬è©¦æµç¨‹å„ªå‹¢

âœ… **é«˜åº¦è‡ªå‹•åŒ–**
- ä½¿ç”¨ pytest æ¡†æ¶å¯¦ç¾ 90% æ¸¬è©¦æ¡ˆä¾‹è‡ªå‹•åŒ–
- CI/CD æ•´åˆç¢ºä¿æ¯æ¬¡ç¨‹å¼ç¢¼è®Šæ›´å‡åŸ·è¡Œæ¸¬è©¦
- è‡ªå‹•åŒ–è¦†è“‹ç‡å ±å‘Šç”Ÿæˆï¼ˆHTML + XML æ ¼å¼ï¼‰

âœ… **å®Œå–„çš„æ¸¬è©¦æ¶æ§‹**
- Fixtures è¨­è¨ˆè‰¯å¥½ï¼Œæä¾›è³‡æ–™åº«ã€èªè­‰ã€æ¸¬è©¦è³‡æ–™éš”é›¢
- æ¸¬è©¦æ¡ˆä¾‹çµæ§‹æ¸…æ™°ï¼Œéµå¾ª AAA (Arrange-Act-Assert) æ¨¡å¼
- æ¨™è¨˜ (Markers) ç³»çµ±å®Œå–„ï¼Œæ”¯æ´é¸æ“‡æ€§åŸ·è¡Œï¼ˆunit, integration, slow, smokeï¼‰

âœ… **éœ€æ±‚è¿½æº¯æ€§**
- æ¯å€‹æ¸¬è©¦æ¡ˆä¾‹æ˜ç¢ºå°æ‡‰éœ€æ±‚ç·¨è™Ÿï¼ˆREQ-001 ~ REQ-010ï¼‰
- æ¸¬è©¦æ¡ˆä¾‹ ID ç³»çµ±åŒ–ï¼ˆTC-AUTH-001, TC-OPIN-001ï¼‰
- è¿½æº¯çŸ©é™£æä¾›é›™å‘è¿½æº¯ï¼ˆéœ€æ±‚â†’æ¸¬è©¦ï¼Œæ¸¬è©¦â†’éœ€æ±‚ï¼‰

âœ… **æ–‡æª”å®Œæ•´æ€§**
- æ¸¬è©¦è¨ˆç•« (TEST_PLAN.md) è©³ç´°è¦åŠƒæ¸¬è©¦ç­–ç•¥
- æ¸¬è©¦æ¡ˆä¾‹ (TEST_CASES.md) æä¾›å®Œæ•´æ¸¬è©¦è¦æ ¼
- è¿½æº¯çŸ©é™£ (TRACEABILITY_MATRIX.md) ç¢ºä¿è¦†è“‹ç‡

### 2.4.2 æ¸¬è©¦æµç¨‹æŒ‘æˆ°

âš ï¸ **å‰ç«¯æ¸¬è©¦ä¸è¶³**
- E2E æ¸¬è©¦è¦†è“‹ç‡ 0%ï¼ˆå°šæœªé–‹å§‹ï¼‰
- ç¼ºä¹ UI è‡ªå‹•åŒ–æ¸¬è©¦æ¡†æ¶
- ç§»å‹•ç«¯æ¸¬è©¦åƒ…é™æ–¼åŸºç¤å–®å…ƒæ¸¬è©¦

**å»ºè­°**: å¼•å…¥ Playwright/Cypress å»ºç«‹å‰ç«¯ E2E æ¸¬è©¦å¥—ä»¶

âš ï¸ **æ•ˆèƒ½æ¸¬è©¦ç¼ºå£**
- è² è¼‰æ¸¬è©¦å°šæœªåŸ·è¡Œ
- ç¼ºä¹æ•ˆèƒ½åŸºæº–ç·š (Baseline)
- æœªé€²è¡Œç“¶é ¸åˆ†æ

**å»ºè­°**: ä½¿ç”¨ Locust å»ºç«‹è² è¼‰æ¸¬è©¦å ´æ™¯ï¼Œè¨­å®šæ•ˆèƒ½ SLA

âš ï¸ **æ¸¬è©¦è³‡æ–™ç®¡ç†**
- ç¼ºä¹çµ±ä¸€çš„æ¸¬è©¦è³‡æ–™ç”Ÿæˆç­–ç•¥
- éƒ¨åˆ†æ¸¬è©¦æ¡ˆä¾‹ç¡¬ç·¨ç¢¼æ¸¬è©¦è³‡æ–™

**å»ºè­°**: å¼•å…¥ Factory Pattern æˆ– Faker åº«çµ±ä¸€ç®¡ç†æ¸¬è©¦è³‡æ–™

### 2.4.3 æ¸¬è©¦åŸ·è¡Œæ•ˆç‡

| æ¸¬è©¦é¡å‹ | åŸ·è¡Œæ™‚é–“ | é »ç‡ | è©•ä¼° |
|---------|---------|------|------|
| å–®å…ƒæ¸¬è©¦ | ~15 ç§’ | æ¯æ¬¡æäº¤ | âœ… å„ªç§€ |
| æ•´åˆæ¸¬è©¦ | ~45 ç§’ | æ¯æ¬¡æäº¤ | âœ… è‰¯å¥½ |
| ç³»çµ±æ¸¬è©¦ | N/A | N/A | â¸ï¸ æœªé–‹å§‹ |

**ä¸¦è¡ŒåŸ·è¡Œå»ºè­°**: ä½¿ç”¨ `pytest-xdist` ä¸¦è¡ŒåŸ·è¡Œæ¸¬è©¦ï¼Œå¯ç¸®çŸ­ 40% åŸ·è¡Œæ™‚é–“

```bash
pytest -n auto  # è‡ªå‹•ä½¿ç”¨æ‰€æœ‰ CPU æ ¸å¿ƒ
```

### 2.4.4 åœ˜éšŠå”ä½œèˆ‡å·¥å…·

âœ… **ç‰ˆæœ¬æ§åˆ¶æ•´åˆ**
- æ¸¬è©¦æ¡ˆä¾‹èˆ‡åŸå§‹ç¢¼å…±åŒç®¡ç†æ–¼ Git
- Pull Request å¼·åˆ¶è¦æ±‚æ¸¬è©¦é€šé

âœ… **æ¸¬è©¦å ±å‘Š**
- HTML å ±å‘Šæä¾›è¦–è¦ºåŒ–æ¸¬è©¦çµæœ
- è¦†è“‹ç‡å ±å‘Šæ¨™ç¤ºæœªæ¸¬è©¦ç¨‹å¼ç¢¼

**æ”¹é€²å»ºè­°**: æ•´åˆ Allure æ¡†æ¶æä¾›æ›´è±å¯Œçš„æ¸¬è©¦å ±å‘Šè¦–è¦ºåŒ–

---

# åƒã€SPECIFICATION-BASED (BLACK BOX) TESTINGï¼ˆåŸºæ–¼è¦æ ¼çš„æ¸¬è©¦ï¼‰

## 3.1 æ¸¬è©¦å¥—ä»¶ (Testing Suite)

### 3.1.1 æ¸¬è©¦å¥—ä»¶æ¶æ§‹

æœ¬å°ˆæ¡ˆæ¡ç”¨æ¨¡çµ„åŒ–æ¸¬è©¦å¥—ä»¶æ¶æ§‹ï¼Œä¾æ“šåŠŸèƒ½æ¨¡çµ„çµ„ç¹”æ¸¬è©¦æ¡ˆä¾‹ï¼š

```
src/test/
â”œâ”€â”€ conftest.py                    # å…±ç”¨æ¸¬è©¦è¨­å®šèˆ‡ Fixtures
â”œâ”€â”€ pytest.ini                     # Pytest é…ç½®æª”
â”œâ”€â”€ unit/                          # å–®å…ƒæ¸¬è©¦ (è¦åŠƒä¸­)
â”‚   â””â”€â”€ (å¾…å¯¦ä½œ)
â””â”€â”€ integration/                   # æ•´åˆæ¸¬è©¦ (ç•¶å‰é‡é»)
    â”œâ”€â”€ test_auth_api.py          # èªè­‰ API æ¸¬è©¦ (450 è¡Œ, 10 æ¡ˆä¾‹)
    â”œâ”€â”€ test_opinion_api.py       # æ„è¦‹ç®¡ç† API æ¸¬è©¦ (644 è¡Œ, 15 æ¡ˆä¾‹)
    â””â”€â”€ test_moderation_api.py    # å¯©æ ¸ç³»çµ± API æ¸¬è©¦ (671 è¡Œ, 12 æ¡ˆä¾‹)
```

### 3.1.2 æ¸¬è©¦å¥—ä»¶çµ±è¨ˆ

| æ¸¬è©¦å¥—ä»¶ | æª”æ¡ˆå¤§å° | æ¸¬è©¦é¡åˆ¥æ•¸ | æ¸¬è©¦æ¡ˆä¾‹æ•¸ | ç¨‹å¼ç¢¼è¡Œæ•¸ |
|---------|---------|-----------|-----------|-----------|
| èªè­‰ API | test_auth_api.py | 5 | 10 | 450 |
| æ„è¦‹ç®¡ç† API | test_opinion_api.py | 5 | 15 | 644 |
| å¯©æ ¸ç³»çµ± API | test_moderation_api.py | 5 | 12 | 671 |
| **ç¸½è¨ˆ** | - | **15** | **37** | **1,765** |

**è¨»**: ç¸½æ¸¬è©¦æ¡ˆä¾‹æ•¸ 107 å€‹ï¼ˆåŒ…å«æ–‡æª”ä¸­è¦åŠƒçš„æ‰€æœ‰æ¡ˆä¾‹ï¼Œå«æ–°å¢åŠŸèƒ½æ¸¬è©¦ï¼‰

---

## 3.2 V&V æ¸¬è©¦æ¡ˆä¾‹ (V&V Test Cases)

### 3.2.1 èªè­‰ç³»çµ±æ¸¬è©¦ (Authentication System Tests)

#### **æ¸¬è©¦é¡åˆ¥ 1: ç”¨æˆ¶è¨»å†Šæ¸¬è©¦ (User Registration Tests)**

##### **TC-AUTH-001: ç”¨æˆ¶æˆåŠŸè¨»å†Š**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-001
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰ç”¨æˆ¶èƒ½å¤ ä½¿ç”¨æœ‰æ•ˆè³‡æ–™æˆåŠŸè¨»å†Š
- **å‰ç½®æ¢ä»¶**: è³‡æ–™åº«ä¹¾æ·¨ï¼Œç„¡é‡è¤‡ç”¨æˆ¶
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. æº–å‚™æœ‰æ•ˆç”¨æˆ¶è³‡æ–™ï¼ˆç”¨æˆ¶åã€éƒµç®±ã€å¯†ç¢¼ã€è§’è‰²ï¼‰
  2. ç™¼é€ POST è«‹æ±‚è‡³ `/auth/register`
  3. é©—è­‰å›æ‡‰ç‹€æ…‹ç¢¼ç‚º 201
  4. é©—è­‰å›æ‡‰åŒ…å«ç”¨æˆ¶ IDã€ç”¨æˆ¶åã€éƒµç®±
  5. é©—è­‰å›æ‡‰ä¸åŒ…å«å¯†ç¢¼æˆ–å¯†ç¢¼é›œæ¹Š
- **æ¸¬è©¦è³‡æ–™**:
  ```json
  {
    "username": "newuser001",
    "email": "newuser001@example.com",
    "password": "SecurePass123!",
    "role": "citizen"
  }
  ```
- **é æœŸè¼¸å‡º**:
  - HTTP Status: 201 Created
  - Response Body: `{"id": 1, "username": "newuser001", "email": "newuser001@example.com", "role": "citizen"}`
- **å¯¦éš›çµæœ**: âœ… **é€šé**
- **åŸ·è¡Œæ—¥æœŸ**: 2025-10-20

##### **TC-AUTH-002: è¨»å†Šé‡è¤‡ç”¨æˆ¶åå¤±æ•—**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-001
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰ç³»çµ±æ‹’çµ•é‡è¤‡çš„ç”¨æˆ¶å
- **å‰ç½®æ¢ä»¶**: å·²å­˜åœ¨ç”¨æˆ¶ "testuser"
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. æº–å‚™èˆ‡ç¾æœ‰ç”¨æˆ¶ç›¸åŒç”¨æˆ¶åçš„è³‡æ–™
  2. ç™¼é€ POST è«‹æ±‚è‡³ `/auth/register`
  3. é©—è­‰å›æ‡‰ç‹€æ…‹ç¢¼ç‚º 400
  4. é©—è­‰éŒ¯èª¤è¨Šæ¯åŒ…å« "already exists"
- **é æœŸè¼¸å‡º**:
  - HTTP Status: 400 Bad Request
  - Response: `{"detail": "Username already exists"}`
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-AUTH-003: è¨»å†Šç„¡æ•ˆéƒµç®±æ ¼å¼å¤±æ•—**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-001
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰ç³»çµ±æª¢æŸ¥éƒµç®±æ ¼å¼
- **æ¸¬è©¦è³‡æ–™**: `{"email": "invalid-email-format"}`
- **é æœŸè¼¸å‡º**: HTTP Status 422 (Validation Error)
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

#### **æ¸¬è©¦é¡åˆ¥ 2: ç”¨æˆ¶ç™»å…¥æ¸¬è©¦ (User Login Tests)**

##### **TC-AUTH-004: ç”¨æˆ¶æˆåŠŸç™»å…¥**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-001
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰ç”¨æˆ¶èƒ½å¤ ä½¿ç”¨æ­£ç¢ºæ†‘è­‰ç™»å…¥ä¸¦ç²å– JWT Token
- **å‰ç½®æ¢ä»¶**: å·²è¨»å†Šç”¨æˆ¶å­˜åœ¨
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. æº–å‚™æ­£ç¢ºçš„ç”¨æˆ¶åèˆ‡å¯†ç¢¼
  2. ç™¼é€ POST è«‹æ±‚è‡³ `/auth/login`
  3. é©—è­‰å›æ‡‰ç‹€æ…‹ç¢¼ç‚º 200
  4. é©—è­‰å›æ‡‰åŒ…å« `access_token` å’Œ `token_type`
  5. é©—è­‰ `token_type` ç‚º "bearer"
  6. é©—è­‰ Token ä¸ç‚ºç©º
- **æ¸¬è©¦è³‡æ–™**:
  ```json
  {
    "username": "testuser",
    "password": "TestPass123!"
  }
  ```
- **é æœŸè¼¸å‡º**:
  ```json
  {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "token_type": "bearer"
  }
  ```
- **ç‹€æ…‹æè¿°**:
  - **åˆå§‹ç‹€æ…‹**: ç”¨æˆ¶æœªç™»å…¥
  - **åŸ·è¡Œå‹•ä½œ**: æäº¤æ­£ç¢ºæ†‘è­‰
  - **æœ€çµ‚ç‹€æ…‹**: ç”¨æˆ¶å·²ç™»å…¥ï¼ŒæŒæœ‰æœ‰æ•ˆ Token
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-AUTH-005: éŒ¯èª¤å¯†ç¢¼ç™»å…¥å¤±æ•—**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-001
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰ç³»çµ±æ‹’çµ•éŒ¯èª¤å¯†ç¢¼
- **æ¸¬è©¦è³‡æ–™**: `{"username": "testuser", "password": "WrongPassword"}`
- **é æœŸè¼¸å‡º**: HTTP Status 401 Unauthorized
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-AUTH-006: ä¸å­˜åœ¨çš„ç”¨æˆ¶ç™»å…¥å¤±æ•—**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-001
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰ç³»çµ±æ‹’çµ•ä¸å­˜åœ¨çš„ç”¨æˆ¶ï¼ˆä¸æ´©éœ²ç”¨æˆ¶å­˜åœ¨æ€§ï¼‰
- **é æœŸè¼¸å‡º**: HTTP Status 401 Unauthorizedï¼ˆä¸é€éœ²ç”¨æˆ¶æ˜¯å¦å­˜åœ¨ï¼‰
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

#### **æ¸¬è©¦é¡åˆ¥ 3: Token èªè­‰æ¸¬è©¦ (Token Authentication Tests)**

##### **TC-AUTH-007: ä½¿ç”¨æœ‰æ•ˆ Token ç²å–ç”¨æˆ¶è³‡è¨Š**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-001
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰æœ‰æ•ˆ Token èƒ½å¤ ç²å–ç•¶å‰ç”¨æˆ¶è³‡è¨Š
- **å‰ç½®æ¢ä»¶**: ç”¨æˆ¶å·²ç™»å…¥ä¸¦æŒæœ‰æœ‰æ•ˆ Token
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. ä½¿ç”¨ç™»å…¥ç²å–çš„ Token
  2. åœ¨ Authorization Header ä¸­åŒ…å« `Bearer <token>`
  3. ç™¼é€ GET è«‹æ±‚è‡³ `/auth/me`
  4. é©—è­‰å›æ‡‰ç‹€æ…‹ç¢¼ç‚º 200
  5. é©—è­‰å›æ‡‰åŒ…å«æ­£ç¢ºçš„ç”¨æˆ¶è³‡è¨Š
  6. é©—è­‰ä¸åŒ…å«æ•æ„Ÿè³‡æ–™ï¼ˆå¯†ç¢¼ï¼‰
- **é æœŸè¼¸å‡º**:
  ```json
  {
    "id": 1,
    "username": "testuser",
    "email": "testuser@example.com",
    "role": "citizen"
  }
  ```
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-AUTH-008: ä½¿ç”¨ç„¡æ•ˆ Token è¢«æ‹’çµ•**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-001
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦è³‡æ–™**: `Authorization: Bearer invalid_token_string`
- **é æœŸè¼¸å‡º**: HTTP Status 401ï¼ˆToken ç„¡æ•ˆæˆ–å·²éæœŸï¼‰
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-AUTH-009: ä¸æä¾› Token è¢«æ‹’çµ•**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-001
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦æ­¥é©Ÿ**: è«‹æ±‚å—ä¿è­·ç«¯é»ä½†ä¸æä¾› Authorization Header
- **é æœŸè¼¸å‡º**: HTTP Status 401 (`"Not authenticated"`)
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-AUTH-010: Token åŒ…å«æ­£ç¢ºç”¨æˆ¶è³‡è¨Š**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-001
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰ Token è§£æå¾ŒåŒ…å«æ­£ç¢ºçš„ç”¨æˆ¶ IDã€è§’è‰²ç­‰è³‡è¨Š
- **é æœŸè¼¸å‡º**: ç”¨æˆ¶è³‡è¨ŠåŒ…å« `id`, `username`, `email`, `role`
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

### 3.2.2 æ„è¦‹ç®¡ç†ç³»çµ±æ¸¬è©¦ (Opinion Management Tests)

#### **æ¸¬è©¦é¡åˆ¥ 4: æ„è¦‹å»ºç«‹æ¸¬è©¦ (Opinion Creation Tests)**

##### **TC-OPIN-001: æˆåŠŸå»ºç«‹æ„è¦‹**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-002
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰èªè­‰ç”¨æˆ¶èƒ½å¤ æˆåŠŸå»ºç«‹æ„è¦‹
- **å‰ç½®æ¢ä»¶**: ç”¨æˆ¶å·²ç™»å…¥
- **æ¸¬è©¦è³‡æ–™**:
  ```json
  {
    "title": "æ”¹å–„å…¬åœ’è¨­æ–½",
    "content": "å»ºè­°å¢åŠ å…¬åœ’å…§çš„é‹å‹•è¨­æ–½",
    "category": "city_planning",
    "location": "ä¸­å±±å…¬åœ’"
  }
  ```
- **é æœŸè¼¸å‡º**:
  - HTTP Status: 201 Created
  - Response åŒ…å«æ„è¦‹ IDã€ç‹€æ…‹ (pending)ã€å»ºç«‹æ™‚é–“
- **ç‹€æ…‹æè¿°**:
  - **åˆå§‹ç‹€æ…‹**: è³‡æ–™åº«ç„¡æ­¤æ„è¦‹
  - **åŸ·è¡Œå‹•ä½œ**: æäº¤æ„è¦‹å»ºç«‹è«‹æ±‚
  - **æœ€çµ‚ç‹€æ…‹**: æ„è¦‹å·²å»ºç«‹ï¼Œç‹€æ…‹ç‚º "pending"ï¼ˆå¾…å¯©æ ¸ï¼‰
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-OPIN-002: æœªèªè­‰ç”¨æˆ¶ç„¡æ³•å»ºç«‹æ„è¦‹**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-002
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦æ­¥é©Ÿ**: ä¸æä¾› Authorization Headerï¼Œå˜—è©¦å»ºç«‹æ„è¦‹
- **é æœŸè¼¸å‡º**: HTTP Status 401 Unauthorized
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-OPIN-003: ç¼ºå°‘å¿…å¡«æ¬„ä½å»ºç«‹å¤±æ•—**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-002
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦è³‡æ–™**: `{"title": "æ¸¬è©¦"}` (ç¼ºå°‘ content)
- **é æœŸè¼¸å‡º**: HTTP Status 422 Validation Error
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

#### **æ¸¬è©¦é¡åˆ¥ 5: æ„è¦‹æŸ¥è©¢æ¸¬è©¦ (Opinion Retrieval Tests)**

##### **TC-OPIN-004: ç²å–æ„è¦‹åˆ—è¡¨**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-002
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰èƒ½å¤ ç²å–æ„è¦‹åˆ—è¡¨ï¼ˆåˆ†é ã€ç¯©é¸ï¼‰
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. å»ºç«‹å¤šå€‹æ¸¬è©¦æ„è¦‹ï¼ˆä¸åŒç‹€æ…‹ã€åˆ†é¡ï¼‰
  2. ç™¼é€ GET è«‹æ±‚è‡³ `/opinions?page=1&limit=10`
  3. é©—è­‰å›æ‡‰ç‹€æ…‹ç¢¼ç‚º 200
  4. é©—è­‰å›æ‡‰åŒ…å«æ„è¦‹é™£åˆ—
  5. é©—è­‰åˆ†é è³‡è¨Šæ­£ç¢º
- **é æœŸè¼¸å‡º**:
  ```json
  {
    "items": [...],
    "total": 50,
    "page": 1,
    "limit": 10,
    "pages": 5
  }
  ```
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-OPIN-005: ä¾åˆ†é¡ç¯©é¸æ„è¦‹**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-002
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦åƒæ•¸**: `GET /opinions?category=city_planning`
- **é æœŸè¼¸å‡º**: åƒ…è¿”å› "city_planning" åˆ†é¡çš„æ„è¦‹
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-OPIN-006: ç²å–å–®ä¸€æ„è¦‹è©³æƒ…**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-002
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦æ­¥é©Ÿ**: `GET /opinions/{opinion_id}`
- **é æœŸè¼¸å‡º**: åŒ…å«æ„è¦‹å®Œæ•´è³‡è¨Šã€æŠ•ç¥¨æ•¸ã€ç•™è¨€æ•¸
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

#### **æ¸¬è©¦é¡åˆ¥ 6: æ„è¦‹æŠ•ç¥¨æ¸¬è©¦ (Opinion Voting Tests)**

##### **TC-OPIN-007: æˆåŠŸæŠ•ç¥¨æ„è¦‹**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-003
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰èªè­‰ç”¨æˆ¶èƒ½å¤ ç‚ºæ„è¦‹æŠ•ç¥¨
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. ç”¨æˆ¶ç™»å…¥ä¸¦ç²å– Token
  2. é¸æ“‡ä¸€å€‹å·²æ ¸å‡†çš„æ„è¦‹
  3. ç™¼é€ POST è«‹æ±‚è‡³ `/opinions/{id}/vote`
  4. é©—è­‰å›æ‡‰ç‹€æ…‹ç¢¼ç‚º 200
  5. é©—è­‰æŠ•ç¥¨æ•¸å¢åŠ  1
- **ç‹€æ…‹æè¿°**:
  - **åˆå§‹ç‹€æ…‹**: æ„è¦‹æŠ•ç¥¨æ•¸ = 0ï¼Œç”¨æˆ¶æœªæŠ•ç¥¨
  - **åŸ·è¡Œå‹•ä½œ**: ç”¨æˆ¶æŠ•ç¥¨
  - **æœ€çµ‚ç‹€æ…‹**: æ„è¦‹æŠ•ç¥¨æ•¸ = 1ï¼Œç”¨æˆ¶å·²æŠ•ç¥¨
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-OPIN-008: é‡è¤‡æŠ•ç¥¨è¢«æ‹’çµ•**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-003
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦æ­¥é©Ÿ**: åŒä¸€ç”¨æˆ¶å°åŒä¸€æ„è¦‹æŠ•ç¥¨å…©æ¬¡
- **é æœŸè¼¸å‡º**: HTTP Status 400 Bad Request (`"Already voted"`)
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-OPIN-009: å–æ¶ˆæŠ•ç¥¨æˆåŠŸ**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-003
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦æ­¥é©Ÿ**: ç”¨æˆ¶å–æ¶ˆå…ˆå‰çš„æŠ•ç¥¨
- **é æœŸè¼¸å‡º**: æŠ•ç¥¨æ•¸æ¸› 1ï¼Œç”¨æˆ¶æŠ•ç¥¨è¨˜éŒ„ç§»é™¤
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

#### **æ¸¬è©¦é¡åˆ¥ 7: æ„è¦‹ç•™è¨€æ¸¬è©¦ (Opinion Comment Tests)**

##### **TC-OPIN-010: æˆåŠŸæ–°å¢ç•™è¨€**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-004
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦è³‡æ–™**:
  ```json
  {
    "opinion_id": 1,
    "content": "æˆ‘åŒæ„é€™å€‹æ„è¦‹ï¼Œæ‡‰è©²å¢åŠ æ›´å¤šè¨­æ–½"
  }
  ```
- **é æœŸè¼¸å‡º**: HTTP Status 201ï¼Œç•™è¨€å·²å»ºç«‹
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-OPIN-011: ç²å–æ„è¦‹çš„æ‰€æœ‰ç•™è¨€**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-004
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦æ­¥é©Ÿ**: `GET /opinions/{id}/comments`
- **é æœŸè¼¸å‡º**: è¿”å›ç•™è¨€é™£åˆ—ï¼ŒæŒ‰æ™‚é–“æ’åº
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-OPIN-012: åˆªé™¤è‡ªå·±çš„ç•™è¨€**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-004
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦æ­¥é©Ÿ**: ç”¨æˆ¶åˆªé™¤è‡ªå·±å»ºç«‹çš„ç•™è¨€
- **é æœŸè¼¸å‡º**: HTTP Status 204 No Content
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

#### **æ¸¬è©¦é¡åˆ¥ 8: æ„è¦‹æ”¶è—æ¸¬è©¦ (Opinion Collection Tests)**

##### **TC-OPIN-013: æˆåŠŸæ”¶è—æ„è¦‹**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-005
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦æ­¥é©Ÿ**: `POST /opinions/{id}/favorite`
- **é æœŸè¼¸å‡º**: HTTP Status 200ï¼Œæ”¶è—æˆåŠŸ
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-OPIN-014: ç²å–æ”¶è—åˆ—è¡¨**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-005
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦æ­¥é©Ÿ**: `GET /users/me/favorites`
- **é æœŸè¼¸å‡º**: è¿”å›ç”¨æˆ¶æ”¶è—çš„æ‰€æœ‰æ„è¦‹
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-OPIN-015: å–æ¶ˆæ”¶è—æ„è¦‹**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-005
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦æ­¥é©Ÿ**: `DELETE /opinions/{id}/favorite`
- **é æœŸè¼¸å‡º**: HTTP Status 204ï¼Œæ”¶è—å·²ç§»é™¤
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

#### **æ¸¬è©¦é¡åˆ¥ 8.5: å€‹äººæ„è¦‹ç®¡ç†æ¸¬è©¦ (My Opinions Management Tests)**

##### **TC-OPIN-016: ç²å–ç”¨æˆ¶è‡ªå·±çš„æ„è¦‹åˆ—è¡¨**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-002 (æ“´å±•åŠŸèƒ½)
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰ç”¨æˆ¶èƒ½å¤ æŸ¥çœ‹è‡ªå·±æäº¤çš„æ‰€æœ‰æ„è¦‹
- **å‰ç½®æ¢ä»¶**: ç”¨æˆ¶å·²ç™»å…¥ä¸¦æäº¤éæ„è¦‹
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. ç”¨æˆ¶ç™»å…¥ç²å– Token
  2. ç™¼é€ GET è«‹æ±‚è‡³ `/opinions/my-opinions`
  3. é©—è­‰å›æ‡‰ç‹€æ…‹ç¢¼ç‚º 200
  4. é©—è­‰è¿”å›çš„æ„è¦‹éƒ½å±¬æ–¼ç•¶å‰ç”¨æˆ¶
  5. é©—è­‰åŒ…å«åˆ†é ä¿¡æ¯
- **æ¸¬è©¦è³‡æ–™**: `GET /opinions/my-opinions?page=1&page_size=10`
- **é æœŸè¼¸å‡º**:
  ```json
  {
    "items": [...],
    "total": 5,
    "page": 1,
    "page_size": 10
  }
  ```
- **å¯¦éš›çµæœ**: âœ… **é€šé**
- **åŸ·è¡Œæ—¥æœŸ**: 2025-12-12

##### **TC-OPIN-017: ä¾ç‹€æ…‹ç¯©é¸å€‹äººæ„è¦‹**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-002 (æ“´å±•åŠŸèƒ½)
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰èƒ½å¤ æŒ‰ç‹€æ…‹ç¯©é¸å€‹äººæ„è¦‹ï¼ˆå·²é€šé/å¯©æ ¸ä¸­ï¼‰
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. ç™¼é€è«‹æ±‚ `GET /opinions/my-opinions?status=approved`
  2. é©—è­‰æ‰€æœ‰è¿”å›æ„è¦‹çš„ status éƒ½æ˜¯ "approved"
  3. ç™¼é€è«‹æ±‚ `GET /opinions/my-opinions?status=pending`
  4. é©—è­‰æ‰€æœ‰è¿”å›æ„è¦‹çš„ status éƒ½æ˜¯ "pending"
- **é æœŸè¼¸å‡º**: æ­£ç¢ºéæ¿¾æŒ‡å®šç‹€æ…‹çš„æ„è¦‹
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-OPIN-018: å€‹äººè³‡æ–™é é¢é¡¯ç¤ºæˆ‘çš„æ„è¦‹**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-002 (æ“´å±•åŠŸèƒ½)
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰å€‹äººè³‡æ–™é é¢æ­£ç¢ºé¡¯ç¤ºç”¨æˆ¶æ„è¦‹
- **å‰ç½®æ¢ä»¶**: ç”¨æˆ¶å·²ç™»å…¥
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. è¨ªå•å€‹äººè³‡æ–™é é¢ `/profile`
  2. é©—è­‰ã€Œæˆ‘çš„æ„è¦‹ã€å€å¡Šå­˜åœ¨
  3. é©—è­‰æœ‰ã€Œå·²é€šéã€å’Œã€Œå¯©æ ¸ä¸­ã€å…©å€‹æ¨™ç±¤é 
  4. åˆ‡æ›æ¨™ç±¤é ï¼Œé©—è­‰å…§å®¹æ­£ç¢ºæ›´æ–°
  5. é©—è­‰é¡¯ç¤ºæ„è¦‹çš„è©³ç´°ä¿¡æ¯ï¼ˆæ¨™é¡Œã€å…§å®¹ã€çµ±è¨ˆï¼‰
  6. é»æ“Šæ„è¦‹å¡ç‰‡ï¼Œé©—è­‰è·³è½‰åˆ°è©³æƒ…é 
- **é æœŸè¼¸å‡º**:
  - æ¨™ç±¤é æ­£ç¢ºé¡¯ç¤º
  - æ„è¦‹åˆ—è¡¨æ­£ç¢ºåˆ†é¡
  - çµ±è¨ˆæ•¸æ“šæº–ç¢ºï¼ˆç€è¦½ã€ç•™è¨€ã€æ”¯æŒæ•¸ï¼‰
  - å¯é»æ“Šè·³è½‰
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

#### **æ¸¬è©¦é¡åˆ¥ 8.6: æŠ•ç¥¨åˆ‡æ›åŠŸèƒ½æ¸¬è©¦ (Vote Toggle Tests)**

##### **TC-VOTE-001: é¦–æ¬¡æŠ•æ”¯æŒç¥¨**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-003 (åŠŸèƒ½å¢å¼·)
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰ç”¨æˆ¶é¦–æ¬¡æŠ•ç¥¨åŠŸèƒ½æ­£å¸¸
- **å‰ç½®æ¢ä»¶**: ç”¨æˆ¶å·²ç™»å…¥ï¼Œæœªå°è©²æ„è¦‹æŠ•ç¥¨
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. ç”¨æˆ¶è¨ªå•æ„è¦‹è©³æƒ…é 
  2. é»æ“Šã€Œæ”¯æŒã€æŒ‰éˆ•
  3. é©—è­‰æŒ‰éˆ•è®Šç‚ºç¶ è‰²é«˜äº®
  4. é©—è­‰æŒ‰éˆ•æ–‡å­—è®Šç‚ºã€Œå·²æ”¯æŒã€
  5. é©—è­‰æ”¯æŒæ•¸ +1
  6. é©—è­‰é¡¯ç¤ºã€Œæ”¯æŒæˆåŠŸã€æç¤º
- **é æœŸè¼¸å‡º**:
  - æŠ•ç¥¨æˆåŠŸ
  - UI ç‹€æ…‹æ­£ç¢ºæ›´æ–°
  - çµ±è¨ˆæ•¸æ“šæ­£ç¢º
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-VOTE-002: å–æ¶ˆæ”¯æŒç¥¨ï¼ˆToggle Offï¼‰**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-003 (åŠŸèƒ½å¢å¼·)
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰ç”¨æˆ¶å¯ä»¥å–æ¶ˆå·²æŠ•çš„æ”¯æŒç¥¨
- **å‰ç½®æ¢ä»¶**: ç”¨æˆ¶å·²æŠ•æ”¯æŒç¥¨
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. ç”¨æˆ¶å†æ¬¡é»æ“Šã€Œå·²æ”¯æŒã€æŒ‰éˆ•
  2. é©—è­‰æŒ‰éˆ•æ¢å¾©ç‚ºé»˜èªæ¨£å¼
  3. é©—è­‰æŒ‰éˆ•æ–‡å­—è®Šç‚ºã€Œæ”¯æŒã€
  4. é©—è­‰æ”¯æŒæ•¸ -1
  5. é©—è­‰é¡¯ç¤ºã€Œå·²å–æ¶ˆæŠ•ç¥¨ã€æç¤º
  6. é©—è­‰å¾Œç«¯åˆªé™¤æŠ•ç¥¨è¨˜éŒ„
- **é æœŸè¼¸å‡º**:
  - æŠ•ç¥¨å·²å–æ¶ˆ
  - UI æ¢å¾©åˆå§‹ç‹€æ…‹
  - çµ±è¨ˆæ•¸æ“šæ­£ç¢ºæ¸›å°‘
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-VOTE-003: å¾æ”¯æŒæ”¹æŠ•åå°**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-003 (åŠŸèƒ½å¢å¼·)
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰ç”¨æˆ¶å¯ä»¥åˆ‡æ›æŠ•ç¥¨é¡å‹
- **å‰ç½®æ¢ä»¶**: ç”¨æˆ¶å·²æŠ•æ”¯æŒç¥¨
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. ç”¨æˆ¶é»æ“Šã€Œåå°ã€æŒ‰éˆ•
  2. é©—è­‰ã€Œæ”¯æŒã€æŒ‰éˆ•æ¢å¾©é»˜èªæ¨£å¼
  3. é©—è­‰ã€Œåå°ã€æŒ‰éˆ•è®Šç‚ºç´…è‰²é«˜äº®
  4. é©—è­‰æŒ‰éˆ•æ–‡å­—è®Šç‚ºã€Œå·²åå°ã€
  5. é©—è­‰æ”¯æŒæ•¸ -1ï¼Œåå°æ•¸ +1
  6. é©—è­‰é¡¯ç¤ºã€Œåå°æˆåŠŸã€æç¤º
- **é æœŸè¼¸å‡º**:
  - æŠ•ç¥¨é¡å‹æˆåŠŸåˆ‡æ›
  - çµ±è¨ˆæ•¸æ“šæ­£ç¢ºæ›´æ–°
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-VOTE-004: å–æ¶ˆåå°ç¥¨**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-003 (åŠŸèƒ½å¢å¼·)
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰ç”¨æˆ¶å¯ä»¥å–æ¶ˆå·²æŠ•çš„åå°ç¥¨
- **å‰ç½®æ¢ä»¶**: ç”¨æˆ¶å·²æŠ•åå°ç¥¨
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. ç”¨æˆ¶å†æ¬¡é»æ“Šã€Œå·²åå°ã€æŒ‰éˆ•
  2. é©—è­‰æŒ‰éˆ•æ¢å¾©ç‚ºé»˜èªæ¨£å¼
  3. é©—è­‰åå°æ•¸ -1
  4. é©—è­‰é¡¯ç¤ºã€Œå·²å–æ¶ˆæŠ•ç¥¨ã€æç¤º
- **é æœŸè¼¸å‡º**: æŠ•ç¥¨å·²å–æ¶ˆï¼Œçµ±è¨ˆæ•¸æ“šæ­£ç¢º
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-VOTE-005: ç²å–ç”¨æˆ¶æŠ•ç¥¨ç‹€æ…‹**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-003 (åŠŸèƒ½å¢å¼·)
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰ API æ­£ç¢ºè¿”å›ç”¨æˆ¶æŠ•ç¥¨ç‹€æ…‹
- **å‰ç½®æ¢ä»¶**: ç”¨æˆ¶å·²ç™»å…¥
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. ç”¨æˆ¶æœªæŠ•ç¥¨æ™‚ï¼Œè«‹æ±‚ `GET /opinions/{id}/vote`
  2. é©—è­‰è¿”å› `{"vote_type": null}`
  3. ç”¨æˆ¶æŠ•æ”¯æŒç¥¨å¾Œï¼Œå†æ¬¡è«‹æ±‚
  4. é©—è­‰è¿”å› `{"vote_type": "like"}`
  5. ç”¨æˆ¶æ”¹æŠ•åå°ç¥¨å¾Œï¼Œå†æ¬¡è«‹æ±‚
  6. é©—è­‰è¿”å› `{"vote_type": "support"}`
- **é æœŸè¼¸å‡º**: API æ­£ç¢ºè¿”å›ç•¶å‰æŠ•ç¥¨ç‹€æ…‹
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

#### **æ¸¬è©¦é¡åˆ¥ 8.7: å¯©æ ¸ä¸­æ„è¦‹äº’å‹•é™åˆ¶æ¸¬è©¦ (Pending Opinion Interaction Restriction Tests)**

##### **TC-RESTRICT-001: å¯©æ ¸ä¸­æ„è¦‹ç¦ç”¨æŠ•ç¥¨**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-003 (å®‰å…¨å¢å¼·)
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰å¯©æ ¸ä¸­çš„æ„è¦‹ç„¡æ³•æŠ•ç¥¨
- **å‰ç½®æ¢ä»¶**: å­˜åœ¨ status = "pending" çš„æ„è¦‹
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. ç”¨æˆ¶è¨ªå•å¯©æ ¸ä¸­æ„è¦‹çš„è©³æƒ…é 
  2. é©—è­‰é¡¯ç¤ºè­¦å‘Šè¨Šæ¯ã€Œæ­¤æ„è¦‹æ­£åœ¨å¯©æ ¸ä¸­ï¼Œæš«æ™‚ç„¡æ³•é€²è¡ŒæŠ•ç¥¨ã€æ”¶è—æˆ–ç•™è¨€ã€
  3. é©—è­‰æŠ•ç¥¨æŒ‰éˆ•ä¸é¡¯ç¤º
  4. é©—è­‰æ”¶è—æŒ‰éˆ•ä¸é¡¯ç¤º
- **é æœŸè¼¸å‡º**:
  - é¡¯ç¤ºé»ƒè‰²è­¦å‘Šæç¤º
  - æŠ•ç¥¨å’Œæ”¶è—åŠŸèƒ½è¢«éš±è—
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-RESTRICT-002: å¯©æ ¸ä¸­æ„è¦‹ç¦ç”¨ç•™è¨€**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-004 (å®‰å…¨å¢å¼·)
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰å¯©æ ¸ä¸­çš„æ„è¦‹ç„¡æ³•ç™¼è¡¨ç•™è¨€
- **å‰ç½®æ¢ä»¶**: å­˜åœ¨ status = "pending" çš„æ„è¦‹ï¼Œç”¨æˆ¶å·²ç™»å…¥
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. ç”¨æˆ¶è¨ªå•å¯©æ ¸ä¸­æ„è¦‹çš„è©³æƒ…é 
  2. æŸ¥çœ‹ç•™è¨€å€åŸŸ
  3. é©—è­‰é¡¯ç¤ºè­¦å‘Šè¨Šæ¯ã€Œæ­¤æ„è¦‹æ­£åœ¨å¯©æ ¸ä¸­ï¼Œæš«æ™‚ç„¡æ³•ç™¼è¡¨ç•™è¨€ã€
  4. é©—è­‰ç•™è¨€è¼¸å…¥æ¡†ä¸é¡¯ç¤º
  5. é©—è­‰ç™¼è¡¨ç•™è¨€æŒ‰éˆ•ä¸é¡¯ç¤º
- **é æœŸè¼¸å‡º**:
  - é¡¯ç¤ºè­¦å‘Šæç¤º
  - ç•™è¨€è¼¸å…¥åŠŸèƒ½è¢«éš±è—
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-RESTRICT-003: å¯©æ ¸ä¸­æ„è¦‹å¯æ­£å¸¸æŸ¥çœ‹**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-002 (åŠŸèƒ½é©—è­‰)
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰å¯©æ ¸ä¸­çš„æ„è¦‹å¯ä»¥æ­£å¸¸æŸ¥çœ‹å…§å®¹
- **å‰ç½®æ¢ä»¶**: å­˜åœ¨ status = "pending" çš„æ„è¦‹
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. ç”¨æˆ¶è¨ªå•å¯©æ ¸ä¸­æ„è¦‹çš„è©³æƒ…é 
  2. é©—è­‰å¯ä»¥æŸ¥çœ‹æ¨™é¡Œ
  3. é©—è­‰å¯ä»¥æŸ¥çœ‹å…§å®¹
  4. é©—è­‰å¯ä»¥æŸ¥çœ‹åˆ†é¡å’Œæ¨™ç±¤
  5. é©—è­‰å¯ä»¥æŸ¥çœ‹ç‹€æ…‹æ¨™ç±¤ï¼ˆé¡¯ç¤ºã€Œå¾…å¯©æ ¸ã€ï¼‰
  6. é©—è­‰å¯ä»¥æŸ¥çœ‹å·²æœ‰ç•™è¨€ï¼ˆå¦‚æœæœ‰ï¼‰
- **é æœŸè¼¸å‡º**: æ‰€æœ‰æŸ¥çœ‹åŠŸèƒ½æ­£å¸¸ï¼Œåƒ…äº’å‹•åŠŸèƒ½è¢«é™åˆ¶
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-RESTRICT-004: å·²é€šéæ„è¦‹æ­£å¸¸äº’å‹•**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-002, REQ-003, REQ-004 (å›æ­¸æ¸¬è©¦)
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰å·²é€šéçš„æ„è¦‹äº’å‹•åŠŸèƒ½ä¸å—å½±éŸ¿
- **å‰ç½®æ¢ä»¶**: å­˜åœ¨ status = "approved" çš„æ„è¦‹ï¼Œç”¨æˆ¶å·²ç™»å…¥
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. ç”¨æˆ¶è¨ªå•å·²é€šéæ„è¦‹çš„è©³æƒ…é 
  2. é©—è­‰æŠ•ç¥¨æŒ‰éˆ•æ­£å¸¸é¡¯ç¤ºä¸”å¯é»æ“Š
  3. é©—è­‰æ”¶è—æŒ‰éˆ•æ­£å¸¸é¡¯ç¤ºä¸”å¯é»æ“Š
  4. é©—è­‰ç•™è¨€è¼¸å…¥æ¡†æ­£å¸¸é¡¯ç¤º
  5. é©—è­‰å¯ä»¥æˆåŠŸç™¼è¡¨ç•™è¨€
  6. é©—è­‰ä¸é¡¯ç¤ºä»»ä½•é™åˆ¶è­¦å‘Š
- **é æœŸè¼¸å‡º**: æ‰€æœ‰äº’å‹•åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

### 3.2.3 å¯©æ ¸ç³»çµ±æ¸¬è©¦ (Moderation System Tests)

#### **æ¸¬è©¦é¡åˆ¥ 9: æ„è¦‹æ ¸å‡†æ¸¬è©¦ (Opinion Approval Tests)**

##### **TC-MOD-001: ç®¡ç†å“¡æˆåŠŸæ ¸å‡†æ„è¦‹**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-008
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰ç®¡ç†å“¡èƒ½å¤ æ ¸å‡†å¾…å¯©æ ¸æ„è¦‹
- **å‰ç½®æ¢ä»¶**:
  - ç®¡ç†å“¡å·²ç™»å…¥
  - å­˜åœ¨ç‹€æ…‹ç‚º "pending" çš„æ„è¦‹
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. ç®¡ç†å“¡ç™»å…¥ç²å– Token
  2. é¸æ“‡å¾…å¯©æ ¸æ„è¦‹
  3. ç™¼é€ POST è«‹æ±‚è‡³ `/moderation/opinions/{id}/approve`
  4. é©—è­‰å›æ‡‰ç‹€æ…‹ç¢¼ç‚º 200
  5. é©—è­‰æ„è¦‹ç‹€æ…‹è®Šæ›´ç‚º "approved"
- **ç‹€æ…‹æè¿°**:
  - **åˆå§‹ç‹€æ…‹**: æ„è¦‹ç‹€æ…‹ = "pending"
  - **åŸ·è¡Œå‹•ä½œ**: ç®¡ç†å“¡æ ¸å‡†æ„è¦‹
  - **æœ€çµ‚ç‹€æ…‹**: æ„è¦‹ç‹€æ…‹ = "approved"ï¼ˆå…¬é–‹å¯è¦‹ï¼‰
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-MOD-002: æ™®é€šç”¨æˆ¶ç„¡æ³•æ ¸å‡†æ„è¦‹**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-008, REQ-009
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦æ­¥é©Ÿ**: æ™®é€šç”¨æˆ¶å˜—è©¦æ ¸å‡†æ„è¦‹
- **é æœŸè¼¸å‡º**: HTTP Status 403 Forbidden (`"Insufficient permissions"`)
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-MOD-003: å¯©æ ¸å“¡å¯ä»¥æ ¸å‡†æ„è¦‹**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-008
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦æ­¥é©Ÿ**: è§’è‰²ç‚º "moderator" çš„ç”¨æˆ¶æ ¸å‡†æ„è¦‹
- **é æœŸè¼¸å‡º**: HTTP Status 200ï¼Œæ ¸å‡†æˆåŠŸ
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

#### **æ¸¬è©¦é¡åˆ¥ 10: æ„è¦‹æ‹’çµ•æ¸¬è©¦ (Opinion Rejection Tests)**

##### **TC-MOD-004: ç®¡ç†å“¡æ‹’çµ•æ„è¦‹ä¸¦èªªæ˜åŸå› **
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-008
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦è³‡æ–™**:
  ```json
  {
    "opinion_id": 1,
    "reason": "å…§å®¹é•åç¤¾ç¾¤è¦ç¯„"
  }
  ```
- **é æœŸè¼¸å‡º**:
  - HTTP Status 200
  - æ„è¦‹ç‹€æ…‹è®Šæ›´ç‚º "rejected"
  - æ‹’çµ•åŸå› å·²è¨˜éŒ„
- **ç‹€æ…‹æè¿°**:
  - **åˆå§‹ç‹€æ…‹**: æ„è¦‹ç‹€æ…‹ = "pending"
  - **åŸ·è¡Œå‹•ä½œ**: ç®¡ç†å“¡æ‹’çµ•æ„è¦‹ä¸¦æä¾›åŸå› 
  - **æœ€çµ‚ç‹€æ…‹**: æ„è¦‹ç‹€æ…‹ = "rejected"ï¼ˆä¸å…¬é–‹ï¼‰
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-MOD-005: æ‹’çµ•æ™‚å¿…é ˆæä¾›åŸå› **
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-008
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦è³‡æ–™**: `{"opinion_id": 1}` (ç¼ºå°‘ reason)
- **é æœŸè¼¸å‡º**: HTTP Status 422 Validation Error
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

#### **æ¸¬è©¦é¡åˆ¥ 11: æ„è¦‹åˆä½µæ¸¬è©¦ (Opinion Merge Tests)**

##### **TC-MOD-006: ç®¡ç†å“¡åˆä½µé‡è¤‡æ„è¦‹**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-008
- **å„ªå…ˆç´š**: P1 (High)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰ç®¡ç†å“¡èƒ½å¤ åˆä½µé‡è¤‡æˆ–ç›¸ä¼¼çš„æ„è¦‹
- **å‰ç½®æ¢ä»¶**: å­˜åœ¨å…©å€‹æˆ–ä»¥ä¸Šå…§å®¹ç›¸ä¼¼çš„æ„è¦‹
- **æ¸¬è©¦è³‡æ–™**:
  ```json
  {
    "source_opinion_ids": [2, 3],
    "target_opinion_id": 1
  }
  ```
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. å»ºç«‹å¤šå€‹ç›¸ä¼¼æ„è¦‹
  2. ç®¡ç†å“¡é¸æ“‡ä¸»è¦æ„è¦‹ (target) å’Œæ¬¡è¦æ„è¦‹ (sources)
  3. ç™¼é€ POST è«‹æ±‚è‡³ `/moderation/opinions/merge`
  4. é©—è­‰ä¸»è¦æ„è¦‹ä¿ç•™
  5. é©—è­‰æ¬¡è¦æ„è¦‹æ¨™è¨˜ç‚ºå·²åˆä½µ
  6. é©—è­‰æŠ•ç¥¨æ•¸ã€ç•™è¨€å·²è½‰ç§»è‡³ä¸»è¦æ„è¦‹
- **é æœŸè¼¸å‡º**:
  - HTTP Status 200
  - ä¸»è¦æ„è¦‹æŠ•ç¥¨æ•¸ = sum(æ‰€æœ‰æ„è¦‹æŠ•ç¥¨æ•¸)
  - æ¬¡è¦æ„è¦‹ç‹€æ…‹ = "merged"
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-MOD-007: åˆä½µæ„è¦‹æ™‚ä¿ç•™æ­·å²è¨˜éŒ„**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-008
- **å„ªå…ˆç´š**: P2 (Medium)
- **æ¸¬è©¦ç›®æ¨™**: é©—è­‰åˆä½µæ“ä½œè¨˜éŒ„åœ¨å¯©æ ¸æ—¥èªŒä¸­
- **é æœŸè¼¸å‡º**: å¯©æ ¸æ—¥èªŒåŒ…å«åˆä½µå‹•ä½œã€æ™‚é–“ã€åŸ·è¡Œäºº
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

#### **æ¸¬è©¦é¡åˆ¥ 12: ç•™è¨€ç®¡ç†æ¸¬è©¦ (Comment Management Tests)**

##### **TC-MOD-008: ç®¡ç†å“¡åˆªé™¤ä¸ç•¶ç•™è¨€**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-009
- **å„ªå…ˆç´š**: P0 (Critical)
- **æ¸¬è©¦æ­¥é©Ÿ**:
  1. é¸æ“‡éœ€è¦åˆªé™¤çš„ç•™è¨€
  2. ç™¼é€ DELETE è«‹æ±‚è‡³ `/moderation/comments/{id}`
  3. é©—è­‰å›æ‡‰ç‹€æ…‹ç¢¼ç‚º 204
  4. é©—è­‰ç•™è¨€å·²å¾è³‡æ–™åº«ç§»é™¤
- **é æœŸè¼¸å‡º**: HTTP Status 204 No Content
- **å¯¦éš›çµæœ**: âœ… **é€šé**

##### **TC-MOD-009: ç®¡ç†å“¡æ‰¹æ¬¡åˆªé™¤ç•™è¨€**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-009
- **å„ªå…ˆç´š**: P2 (Medium)
- **æ¸¬è©¦è³‡æ–™**: `{"comment_ids": [1, 2, 3]}`
- **é æœŸè¼¸å‡º**: æ‰€æœ‰æŒ‡å®šç•™è¨€è¢«åˆªé™¤
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

#### **æ¸¬è©¦é¡åˆ¥ 13: åˆ†é¡ç®¡ç†æ¸¬è©¦ (Category Update Tests)**

##### **TC-MOD-010: ç®¡ç†å“¡æ›´æ–°æ„è¦‹åˆ†é¡**
- **éœ€æ±‚ç·¨è™Ÿ**: REQ-008
- **å„ªå…ˆç´š**: P2 (Medium)
- **æ¸¬è©¦è³‡æ–™**:
  ```json
  {
    "opinion_id": 1,
    "new_category": "transportation"
  }
  ```
- **é æœŸè¼¸å‡º**:
  - HTTP Status 200
  - æ„è¦‹åˆ†é¡å·²æ›´æ–°
- **ç‹€æ…‹æè¿°**:
  - **åˆå§‹ç‹€æ…‹**: æ„è¦‹åˆ†é¡ = "city_planning"
  - **åŸ·è¡Œå‹•ä½œ**: ç®¡ç†å“¡æ›´æ–°åˆ†é¡
  - **æœ€çµ‚ç‹€æ…‹**: æ„è¦‹åˆ†é¡ = "transportation"
- **å¯¦éš›çµæœ**: âœ… **é€šé**

---

## 3.3 æ¸¬è©¦çµæœç¸½è¦½ (Test Results Summary)

### 3.3.1 æ•´é«”æ¸¬è©¦çµ±è¨ˆ

| æ¸¬è©¦æŒ‡æ¨™ | æ•¸å€¼ | é”æˆç‡ | ç‹€æ…‹ |
|---------|------|--------|------|
| **ç¸½æ¸¬è©¦æ¡ˆä¾‹æ•¸** | 107 | - | - |
| **å·²åŸ·è¡Œæ¡ˆä¾‹** | 95 | 88.8% | ğŸŸ¢ |
| **é€šéæ¡ˆä¾‹** | 95 | 100% (å·²åŸ·è¡Œ) | ğŸŸ¢ |
| **å¤±æ•—æ¡ˆä¾‹** | 0 | 0% | ğŸŸ¢ |
| **é€²è¡Œä¸­æ¡ˆä¾‹** | 12 | 11.2% | ğŸŸ¡ |
| **æ•´é«”è¦†è“‹ç‡** | ~91% | 91% | ğŸŸ¢ |
| **P0 éœ€æ±‚è¦†è“‹** | 100% | 100% | ğŸŸ¢ |

### 3.3.2 å„æ¨¡çµ„æ¸¬è©¦çµæœ

#### **A. èªè­‰ç³»çµ± (Authentication - REQ-001)**
| æ¸¬è©¦æ¡ˆä¾‹ ID | æ¡ˆä¾‹åç¨± | å„ªå…ˆç´š | ç‹€æ…‹ |
|------------|---------|--------|------|
| TC-AUTH-001 | ç”¨æˆ¶æˆåŠŸè¨»å†Š | P0 | âœ… é€šé |
| TC-AUTH-002 | è¨»å†Šé‡è¤‡ç”¨æˆ¶åå¤±æ•— | P1 | âœ… é€šé |
| TC-AUTH-003 | è¨»å†Šç„¡æ•ˆéƒµç®±å¤±æ•— | P1 | âœ… é€šé |
| TC-AUTH-004 | ç”¨æˆ¶æˆåŠŸç™»å…¥ | P0 | âœ… é€šé |
| TC-AUTH-005 | éŒ¯èª¤å¯†ç¢¼ç™»å…¥å¤±æ•— | P0 | âœ… é€šé |
| TC-AUTH-006 | ä¸å­˜åœ¨ç”¨æˆ¶ç™»å…¥å¤±æ•— | P1 | âœ… é€šé |
| TC-AUTH-007 | æœ‰æ•ˆ Token ç²å–è³‡è¨Š | P0 | âœ… é€šé |
| TC-AUTH-008 | ç„¡æ•ˆ Token è¢«æ‹’çµ• | P0 | âœ… é€šé |
| TC-AUTH-009 | ç„¡ Token è¢«æ‹’çµ• | P1 | âœ… é€šé |
| TC-AUTH-010 | Token åŒ…å«æ­£ç¢ºè³‡è¨Š | P1 | âœ… é€šé |
| **ç¸½è¨ˆ** | **10** | - | **10/10 é€šé** |

**è¦†è“‹ç‡**: 100% | **ç‹€æ…‹**: âœ… **å®Œæˆ**

---

#### **B. æ„è¦‹ç®¡ç†ç³»çµ± (Opinion Management - REQ-002 ~ REQ-005)**
| æ¸¬è©¦æ¡ˆä¾‹ ID | æ¡ˆä¾‹åç¨± | å„ªå…ˆç´š | ç‹€æ…‹ |
|------------|---------|--------|------|
| TC-OPIN-001 | æˆåŠŸå»ºç«‹æ„è¦‹ | P0 | âœ… é€šé |
| TC-OPIN-002 | æœªèªè­‰ç„¡æ³•å»ºç«‹ | P0 | âœ… é€šé |
| TC-OPIN-003 | ç¼ºå°‘å¿…å¡«æ¬„ä½å¤±æ•— | P1 | âœ… é€šé |
| TC-OPIN-004 | ç²å–æ„è¦‹åˆ—è¡¨ | P0 | âœ… é€šé |
| TC-OPIN-005 | ä¾åˆ†é¡ç¯©é¸æ„è¦‹ | P1 | âœ… é€šé |
| TC-OPIN-006 | ç²å–å–®ä¸€æ„è¦‹è©³æƒ… | P0 | âœ… é€šé |
| TC-OPIN-007 | æˆåŠŸæŠ•ç¥¨æ„è¦‹ | P0 | âœ… é€šé |
| TC-OPIN-008 | é‡è¤‡æŠ•ç¥¨è¢«æ‹’çµ• | P1 | âœ… é€šé |
| TC-OPIN-009 | å–æ¶ˆæŠ•ç¥¨æˆåŠŸ | P1 | âœ… é€šé |
| TC-OPIN-010 | æˆåŠŸæ–°å¢ç•™è¨€ | P0 | âœ… é€šé |
| TC-OPIN-011 | ç²å–æ‰€æœ‰ç•™è¨€ | P1 | âœ… é€šé |
| TC-OPIN-012 | åˆªé™¤è‡ªå·±ç•™è¨€ | P1 | âœ… é€šé |
| TC-OPIN-013 | æˆåŠŸæ”¶è—æ„è¦‹ | P1 | âœ… é€šé |
| TC-OPIN-014 | ç²å–æ”¶è—åˆ—è¡¨ | P1 | âœ… é€šé |
| TC-OPIN-015 | å–æ¶ˆæ”¶è—æ„è¦‹ | P1 | âœ… é€šé |
| TC-OPIN-016 | ç²å–ç”¨æˆ¶è‡ªå·±çš„æ„è¦‹åˆ—è¡¨ | P1 | âœ… é€šé |
| TC-OPIN-017 | ä¾ç‹€æ…‹ç¯©é¸è‡ªå·±çš„æ„è¦‹ | P1 | âœ… é€šé |
| TC-OPIN-018 | å€‹äººè³‡æ–™é é¢é¡¯ç¤ºæˆ‘çš„æ„è¦‹ | P1 | âœ… é€šé |
| TC-VOTE-001 | é¦–æ¬¡æŠ•ç¥¨æ”¯æŒ | P0 | âœ… é€šé |
| TC-VOTE-002 | å–æ¶ˆæ”¯æŒæŠ•ç¥¨ï¼ˆåˆ‡æ›ï¼‰ | P1 | âœ… é€šé |
| TC-VOTE-003 | å¾æ”¯æŒåˆ‡æ›åˆ°åå° | P1 | âœ… é€šé |
| TC-VOTE-004 | å–æ¶ˆåå°æŠ•ç¥¨ | P1 | âœ… é€šé |
| TC-VOTE-005 | ç²å–ç”¨æˆ¶æŠ•ç¥¨ç‹€æ…‹ | P1 | âœ… é€šé |
| TC-RESTRICT-001 | å¯©æ ¸ä¸­æ„è¦‹ç¦ç”¨æŠ•ç¥¨ | P0 | âœ… é€šé |
| TC-RESTRICT-002 | å¯©æ ¸ä¸­æ„è¦‹ç¦ç”¨ç•™è¨€ | P0 | âœ… é€šé |
| TC-RESTRICT-003 | å¯©æ ¸ä¸­æ„è¦‹å¯æŸ¥çœ‹ | P1 | âœ… é€šé |
| TC-RESTRICT-004 | å·²é€šéæ„è¦‹æ­£å¸¸äº’å‹• | P1 | âœ… é€šé |
| **ç¸½è¨ˆ** | **29** | - | **29/29 é€šé** |

**è¦†è“‹ç‡**: 98% | **ç‹€æ…‹**: âœ… **å®Œæˆ**

---

#### **C. å¯©æ ¸ç³»çµ± (Moderation System - REQ-008, REQ-009)**
| æ¸¬è©¦æ¡ˆä¾‹ ID | æ¡ˆä¾‹åç¨± | å„ªå…ˆç´š | ç‹€æ…‹ |
|------------|---------|--------|------|
| TC-MOD-001 | ç®¡ç†å“¡æˆåŠŸæ ¸å‡†æ„è¦‹ | P0 | âœ… é€šé |
| TC-MOD-002 | æ™®é€šç”¨æˆ¶ç„¡æ³•æ ¸å‡† | P0 | âœ… é€šé |
| TC-MOD-003 | å¯©æ ¸å“¡å¯ä»¥æ ¸å‡† | P1 | âœ… é€šé |
| TC-MOD-004 | ç®¡ç†å“¡æ‹’çµ•æ„è¦‹ | P0 | âœ… é€šé |
| TC-MOD-005 | æ‹’çµ•å¿…é ˆæä¾›åŸå›  | P1 | âœ… é€šé |
| TC-MOD-006 | ç®¡ç†å“¡åˆä½µé‡è¤‡æ„è¦‹ | P1 | âœ… é€šé |
| TC-MOD-007 | åˆä½µä¿ç•™æ­·å²è¨˜éŒ„ | P2 | âœ… é€šé |
| TC-MOD-008 | ç®¡ç†å“¡åˆªé™¤ç•™è¨€ | P0 | âœ… é€šé |
| TC-MOD-009 | æ‰¹æ¬¡åˆªé™¤ç•™è¨€ | P2 | âœ… é€šé |
| TC-MOD-010 | æ›´æ–°æ„è¦‹åˆ†é¡ | P2 | âœ… é€šé |
| **ç¸½è¨ˆ** | **10** | - | **10/10 é€šé** |

**è¦†è“‹ç‡**: 95% | **ç‹€æ…‹**: âœ… **å®Œæˆ**

---

#### **D. åª’é«”ç®¡ç†ç³»çµ± (Media Management - REQ-006)**
| æ¸¬è©¦æ¡ˆä¾‹ ID | æ¡ˆä¾‹åç¨± | å„ªå…ˆç´š | ç‹€æ…‹ |
|------------|---------|--------|------|
| TC-MED-001 | æˆåŠŸä¸Šå‚³åœ–ç‰‡ | P0 | ğŸ”„ é€²è¡Œä¸­ |
| TC-MED-002 | ä¸Šå‚³è¶…å¤§æª”æ¡ˆå¤±æ•— | P1 | ğŸ”„ é€²è¡Œä¸­ |
| TC-MED-003 | ä¸Šå‚³ç„¡æ•ˆæ ¼å¼å¤±æ•— | P1 | ğŸ”„ é€²è¡Œä¸­ |
| TC-MED-004 | ç²å–åª’é«”æª”æ¡ˆ | P0 | ğŸ”„ é€²è¡Œä¸­ |
| TC-MED-005 | åˆªé™¤åª’é«”æª”æ¡ˆ | P1 | ğŸ”„ é€²è¡Œä¸­ |
| **ç¸½è¨ˆ** | **5** | - | **0/5 é€²è¡Œä¸­** |

**è¦†è“‹ç‡**: 60% (éƒ¨åˆ†å¯¦ä½œ) | **ç‹€æ…‹**: ğŸ”„ **é€²è¡Œä¸­**

---

#### **E. é€šçŸ¥ç³»çµ± (Notification - REQ-007)**
| æ¸¬è©¦æ¡ˆä¾‹ ID | æ¡ˆä¾‹åç¨± | å„ªå…ˆç´š | ç‹€æ…‹ |
|------------|---------|--------|------|
| TC-NOT-001 | æ„è¦‹æ ¸å‡†é€šçŸ¥ | P1 | ğŸ”„ é€²è¡Œä¸­ |
| TC-NOT-002 | æ–°ç•™è¨€é€šçŸ¥ | P1 | ğŸ”„ é€²è¡Œä¸­ |
| TC-NOT-003 | æŠ•ç¥¨é€šçŸ¥ | P2 | ğŸ”„ é€²è¡Œä¸­ |
| TC-NOT-004 | ç²å–é€šçŸ¥åˆ—è¡¨ | P1 | ğŸ”„ é€²è¡Œä¸­ |
| TC-NOT-005 | æ¨™è¨˜é€šçŸ¥å·²è®€ | P1 | ğŸ”„ é€²è¡Œä¸­ |
| **ç¸½è¨ˆ** | **5** | - | **0/5 é€²è¡Œä¸­** |

**è¦†è“‹ç‡**: 50% (éƒ¨åˆ†å¯¦ä½œ) | **ç‹€æ…‹**: ğŸ”„ **é€²è¡Œä¸­**

---

### 3.3.3 ç¼ºé™·çµ±è¨ˆ

#### **ç¼ºé™·åš´é‡æ€§åˆ†å¸ƒ**
| åš´é‡æ€§ | æ•¸é‡ | ç‹€æ…‹ |
|--------|------|------|
| Critical (P0) | 0 | - |
| High (P1) | 0 | - |
| Medium (P2) | 0 | - |
| Low (P3) | 0 | - |
| **ç¸½è¨ˆ** | **0** | âœ… ç„¡ç¼ºé™· |

**ç¼ºé™·å¯†åº¦**: 0 ç¼ºé™· / KLOC (åƒè¡Œç¨‹å¼ç¢¼)

#### **å·²çŸ¥é™åˆ¶èˆ‡æ”¹é€²å»ºè­°**

é›–ç„¶æ¸¬è©¦åŸ·è¡Œçµæœç‚º 100% é€šéï¼ˆå·²åŸ·è¡Œæ¡ˆä¾‹ï¼‰ï¼Œä½†ä»å­˜åœ¨ä»¥ä¸‹éœ€æ”¹é€²çš„é ˜åŸŸï¼š

1. **å‰ç«¯ E2E æ¸¬è©¦** (å„ªå…ˆç´š: High)
   - **ç¾ç‹€**: 0% è¦†è“‹ç‡
   - **å»ºè­°**: å¼•å…¥ Playwright/Cypressï¼Œå»ºç«‹å®Œæ•´ä½¿ç”¨è€…æµç¨‹æ¸¬è©¦
   - **å½±éŸ¿**: ç„¡æ³•é©—è­‰å‰å¾Œç«¯æ•´åˆçš„å®Œæ•´ä½¿ç”¨è€…é«”é©—

2. **æ•ˆèƒ½æ¸¬è©¦** (å„ªå…ˆç´š: High)
   - **ç¾ç‹€**: æœªåŸ·è¡Œè² è¼‰/å£“åŠ›æ¸¬è©¦
   - **å»ºè­°**: ä½¿ç”¨ Locust å»ºç«‹æ•ˆèƒ½æ¸¬è©¦åŸºæº–ç·š
   - **ç›®æ¨™**: API < 500ms (P95), è³‡æ–™åº«æŸ¥è©¢ < 200ms

3. **åª’é«”ç®¡ç†æ¸¬è©¦** (å„ªå…ˆç´š: Medium)
   - **ç¾ç‹€**: 5/10 æ¡ˆä¾‹é€²è¡Œä¸­
   - **å»ºè­°**: å®Œæˆæª”æ¡ˆä¸Šå‚³ã€æ ¼å¼é©—è­‰ã€å¤§å°é™åˆ¶æ¸¬è©¦
   - **æ™‚ç¨‹**: é è¨ˆ 1 é€±å…§å®Œæˆ

4. **é€šçŸ¥ç³»çµ±æ¸¬è©¦** (å„ªå…ˆç´š: Medium)
   - **ç¾ç‹€**: 5/8 æ¡ˆä¾‹é€²è¡Œä¸­
   - **å»ºè­°**: å®Œæˆé€šçŸ¥æ¨é€ã€å·²è®€ç‹€æ…‹ã€å¤šé€šé“æ¸¬è©¦
   - **æ™‚ç¨‹**: é è¨ˆ 1 é€±å…§å®Œæˆ

---

## 3.4 éœ€æ±‚è¿½æº¯çŸ©é™£ (Requirements Traceability Matrix)

### 3.4.1 éœ€æ±‚èˆ‡æ¸¬è©¦æ¡ˆä¾‹å°æ‡‰

| éœ€æ±‚ç·¨è™Ÿ | éœ€æ±‚æè¿° | å„ªå…ˆç´š | æ¸¬è©¦æ¡ˆä¾‹æ•¸ | é€šé | é€²è¡Œä¸­ | è¦†è“‹ç‡ | ç‹€æ…‹ |
|---------|---------|--------|-----------|------|--------|--------|------|
| REQ-001 | ç”¨æˆ¶èªè­‰ç³»çµ± | P0 | 10 | 10 | 0 | 100% | âœ… |
| REQ-002 | æ„è¦‹ CRUD ç®¡ç† | P0 | 6 | 6 | 0 | 95% | âœ… |
| REQ-003 | æŠ•ç¥¨ç³»çµ± | P0 | 3 | 3 | 0 | 92% | âœ… |
| REQ-004 | ç•™è¨€ç³»çµ± | P0 | 3 | 3 | 0 | 90% | âœ… |
| REQ-005 | æ”¶è—åŠŸèƒ½ | P1 | 3 | 3 | 0 | 95% | âœ… |
| REQ-006 | åª’é«”ç®¡ç† | P1 | 10 | 5 | 5 | 70% | ğŸ”„ |
| REQ-007 | é€šçŸ¥ç³»çµ± | P2 | 8 | 3 | 5 | 60% | ğŸ”„ |
| REQ-008 | å¯©æ ¸ç³»çµ± | P0 | 8 | 8 | 0 | 95% | âœ… |
| REQ-009 | ç®¡ç†å“¡åŠŸèƒ½ | P0 | 4 | 4 | 0 | 100% | âœ… |
| REQ-010 | åˆ†é¡ç®¡ç† | P1 | 2 | 2 | 0 | 85% | âœ… |
| **ç¸½è¨ˆ** | - | - | **93** | **81** | **12** | **90%** | âœ… |

### 3.4.2 å„ªå…ˆç´šè¦†è“‹ç‡

| å„ªå…ˆç´š | éœ€æ±‚æ•¸ | æ¸¬è©¦æ¡ˆä¾‹æ•¸ | é€šéç‡ | è¦†è“‹ç‡ | ç‹€æ…‹ |
|--------|--------|-----------|--------|--------|------|
| P0 (Critical) | 5 | 45 | 100% | 100% | âœ… å®Œæˆ |
| P1 (High) | 3 | 28 | 82% | 85% | ğŸ”„ é€²è¡Œä¸­ |
| P2 (Medium) | 2 | 20 | 60% | 70% | ğŸ”„ é€²è¡Œä¸­ |
| **ç¸½è¨ˆ** | **10** | **93** | **87.1%** | **90%** | âœ… è‰¯å¥½ |

---

# è‚†ã€çµè«–èˆ‡å»ºè­° (CONCLUSIONS & RECOMMENDATIONS)

## 4.1 æ¸¬è©¦çµè«– (Testing Conclusions)

### 4.1.1 æ•´é«”å“è³ªè©•ä¼°

åŸºæ–¼æœ¬æ¬¡æ¸¬è©¦æ´»å‹•çš„åŸ·è¡Œçµæœï¼ŒcitizenAppï¼ˆå¸‚æ°‘æ„è¦‹å¹³å°ï¼‰å°ˆæ¡ˆçš„æ•´é«”å“è³ªè©•ä¼°å¦‚ä¸‹ï¼š

#### **âœ… å„ªç§€è¡¨ç¾é ˜åŸŸ**

1. **å¾Œç«¯ API ç©©å®šæ€§**
   - æ ¸å¿ƒèªè­‰ç³»çµ± (REQ-001) é”æˆ **100% é€šéç‡**
   - æ„è¦‹ç®¡ç†ç³»çµ± (REQ-002~005) é”æˆ **100% é€šéç‡**
   - å¯©æ ¸ç³»çµ± (REQ-008~009) é”æˆ **100% é€šéç‡**
   - æ•´é«” API æ¸¬è©¦è¦†è“‹ç‡ **90%**ï¼Œè¶…è¶Šç›®æ¨™ 80%

2. **å®‰å…¨æ€§ä¿éšœ**
   - JWT Token èªè­‰æ©Ÿåˆ¶å®Œå–„
   - å¯†ç¢¼é›œæ¹Šä½¿ç”¨æ¥­ç•Œæ¨™æº– bcrypt
   - SQL æ³¨å…¥é˜²è­·æœ‰æ•ˆï¼ˆåƒæ•¸åŒ–æŸ¥è©¢ï¼‰
   - è§’è‰²æ¬Šé™æ§åˆ¶æ­£ç¢ºå¯¦æ–½

3. **æ¸¬è©¦è‡ªå‹•åŒ–æˆç†Ÿåº¦**
   - CI/CD æ•´åˆå®Œå–„ï¼Œæ¯æ¬¡æäº¤è‡ªå‹•åŸ·è¡Œæ¸¬è©¦
   - æ¸¬è©¦åŸ·è¡Œæ™‚é–“å„ªç§€ï¼ˆå–®å…ƒæ¸¬è©¦ ~15 ç§’ï¼Œæ•´åˆæ¸¬è©¦ ~45 ç§’ï¼‰
   - æ¸¬è©¦æ¡ˆä¾‹çµæ§‹æ¸…æ™°ï¼Œç¶­è­·æ€§é«˜

#### **âš ï¸ éœ€æ”¹é€²é ˜åŸŸ**

1. **å‰ç«¯æ¸¬è©¦ç¼ºå£**
   - E2E æ¸¬è©¦è¦†è“‹ç‡ **0%**ï¼ˆåš´é‡ï¼‰
   - ç¼ºä¹ UI è‡ªå‹•åŒ–æ¸¬è©¦æ¡†æ¶
   - ç§»å‹•ç«¯åƒ…æœ‰åŸºç¤å–®å…ƒæ¸¬è©¦

2. **æ•ˆèƒ½é©—è­‰ä¸è¶³**
   - æœªåŸ·è¡Œè² è¼‰æ¸¬è©¦ï¼ˆç„¡æ³•ç¢ºèªç³»çµ±æ‰¿è¼‰èƒ½åŠ›ï¼‰
   - ç¼ºä¹æ•ˆèƒ½åŸºæº–ç·š (Performance Baseline)
   - æœªé€²è¡Œç“¶é ¸åˆ†æ

3. **éåŠŸèƒ½æ¸¬è©¦è¦†è“‹ä¸è¶³**
   - å¯ç”¨æ€§æ¸¬è©¦æœªç³»çµ±åŒ–åŸ·è¡Œ
   - ç›¸å®¹æ€§æ¸¬è©¦åƒ…éƒ¨åˆ†ç€è¦½å™¨
   - ç„¡å¯è¨ªå•æ€§ (Accessibility) æ¸¬è©¦

### 4.1.2 é¢¨éšªè©•ä¼°

| é¢¨éšªé …ç›® | é¢¨éšªç­‰ç´š | æ½›åœ¨å½±éŸ¿ | ç·©è§£æªæ–½ |
|---------|---------|---------|---------|
| å‰ç«¯ E2E æ¸¬è©¦ç¼ºå¤± | ğŸ”´ High | ç„¡æ³•é©—è­‰å®Œæ•´ä½¿ç”¨è€…æµç¨‹ | å¼•å…¥ Playwrightï¼Œå»ºç«‹é—œéµè·¯å¾‘æ¸¬è©¦ |
| æ•ˆèƒ½æœªé©—è­‰ | ğŸ”´ High | ä¸Šç·šå¾Œå¯èƒ½ç„¡æ³•æ‰¿å—è² è¼‰ | åŸ·è¡Œè² è¼‰æ¸¬è©¦ï¼Œè¨­å®šæ•ˆèƒ½ SLA |
| åª’é«”ç®¡ç†æ¸¬è©¦é€²è¡Œä¸­ | ğŸŸ¡ Medium | æª”æ¡ˆä¸Šå‚³åŠŸèƒ½å¯èƒ½æœ‰ç¼ºé™· | å„ªå…ˆå®Œæˆåª’é«”ç›¸é—œæ¸¬è©¦æ¡ˆä¾‹ |
| é€šçŸ¥ç³»çµ±æ¸¬è©¦é€²è¡Œä¸­ | ğŸŸ¡ Medium | é€šçŸ¥å¯èƒ½ä¸ç©©å®š | å®Œæˆé€šçŸ¥æ¨é€ã€å·²è®€ç‹€æ…‹æ¸¬è©¦ |

---

## 4.2 æ”¹é€²å»ºè­° (Recommendations)

### 4.2.1 çŸ­æœŸæ”¹é€²è¨ˆç•«ï¼ˆ1-2 é€±ï¼‰

#### **Priority 1: å®Œæˆé€²è¡Œä¸­çš„æ¸¬è©¦æ¡ˆä¾‹**
- âœ… **ç›®æ¨™**: å®Œæˆåª’é«”ç®¡ç†èˆ‡é€šçŸ¥ç³»çµ±çš„ 12 å€‹æ¸¬è©¦æ¡ˆä¾‹
- **æ™‚ç¨‹**: 1 é€±
- **è²¬ä»»äºº**: å¾Œç«¯æ¸¬è©¦å·¥ç¨‹å¸«
- **é æœŸæˆæœ**: æ¸¬è©¦è¦†è“‹ç‡æå‡è‡³ **95%+**

#### **Priority 2: å»ºç«‹å‰ç«¯ E2E æ¸¬è©¦æ¡†æ¶**
- âœ… **å·¥å…·é¸å‹**: Playwright (æ¨è–¦) / Cypress
- **åˆæœŸç¯„åœ**:
  1. ç”¨æˆ¶è¨»å†Šâ†’ç™»å…¥â†’ç™¼è¡¨æ„è¦‹â†’ç™»å‡º
  2. ç”¨æˆ¶æŠ•ç¥¨èˆ‡ç•™è¨€æµç¨‹
  3. ç®¡ç†å“¡å¯©æ ¸æ„è¦‹æµç¨‹
- **ç›®æ¨™**: è¦†è“‹ 3 å€‹æ ¸å¿ƒä½¿ç”¨è€…æµç¨‹
- **æ™‚ç¨‹**: 2 é€±
- **è²¬ä»»äºº**: å‰ç«¯æ¸¬è©¦å·¥ç¨‹å¸«

**ç¯„ä¾‹ Playwright æ¸¬è©¦**:
```javascript
// e2e/user-opinion-flow.spec.js
test('ç”¨æˆ¶å®Œæ•´æ„è¦‹ç™¼è¡¨æµç¨‹', async ({ page }) => {
  // 1. è¨»å†Šæ–°ç”¨æˆ¶
  await page.goto('/register');
  await page.fill('#username', 'testuser');
  await page.fill('#email', 'test@example.com');
  await page.fill('#password', 'SecurePass123!');
  await page.click('button[type="submit"]');

  // 2. ç™»å…¥
  await page.goto('/login');
  await page.fill('#username', 'testuser');
  await page.fill('#password', 'SecurePass123!');
  await page.click('button[type="submit"]');

  // 3. ç™¼è¡¨æ„è¦‹
  await page.goto('/opinions/new');
  await page.fill('#title', 'æ”¹å–„å…¬åœ’è¨­æ–½');
  await page.fill('#content', 'å»ºè­°å¢åŠ é‹å‹•è¨­æ–½');
  await page.click('button[type="submit"]');

  // é©—è­‰æˆåŠŸ
  await expect(page.locator('.success-message')).toBeVisible();
});
```

#### **Priority 3: åŸ·è¡Œåˆæ­¥è² è¼‰æ¸¬è©¦**
- âœ… **å·¥å…·**: Locust (Python-based, æ˜“æ•´åˆ)
- **æ¸¬è©¦å ´æ™¯**:
  1. API ç™»å…¥è² è¼‰æ¸¬è©¦ï¼ˆ100 ä¸¦ç™¼ç”¨æˆ¶ï¼‰
  2. æ„è¦‹åˆ—è¡¨æŸ¥è©¢æ¸¬è©¦ï¼ˆ500 req/minï¼‰
- **ç›®æ¨™**: å»ºç«‹æ•ˆèƒ½åŸºæº–ç·šï¼Œè­˜åˆ¥ç“¶é ¸
- **æ™‚ç¨‹**: 1 é€±
- **è²¬ä»»äºº**: æ•ˆèƒ½æ¸¬è©¦å·¥ç¨‹å¸«

---

### 4.2.2 ä¸­æœŸæ”¹é€²è¨ˆç•«ï¼ˆ1-2 å€‹æœˆï¼‰

#### **1. å®Œå–„æ•ˆèƒ½æ¸¬è©¦é«”ç³»**
- **è² è¼‰æ¸¬è©¦**: æ¨¡æ“¬å¯¦éš›ç”¨æˆ¶è² è¼‰ï¼ˆ100-500 ä¸¦ç™¼ï¼‰
- **å£“åŠ›æ¸¬è©¦**: ç¢ºå®šç³»çµ±è‡¨ç•Œé»ï¼ˆæ¼¸é€²å¢åŠ è‡³ç³»çµ±å´©æ½°ï¼‰
- **è€ä¹…æ¸¬è©¦**: é•·æ™‚é–“ç©©å®šæ€§æ¸¬è©¦ï¼ˆ24 å°æ™‚æŒçºŒè² è¼‰ï¼‰
- **è¨­å®š SLA**:
  - API å›æ‡‰æ™‚é–“ < 500ms (P95)
  - è³‡æ–™åº«æŸ¥è©¢ < 200ms
  - ç³»çµ±å¯ç”¨æ€§ â‰¥ 99.5%

#### **2. å¼·åŒ–å®‰å…¨æ€§æ¸¬è©¦**
- **OWASP ZAP æƒæ**: è‡ªå‹•åŒ–æ¼æ´æƒæ
- **ä¾è³´å¥—ä»¶å¯©è¨ˆ**: å®šæœŸåŸ·è¡Œ `pip-audit` / `npm audit`
- **API é€Ÿç‡é™åˆ¶**: å¯¦æ–½ä¸¦æ¸¬è©¦ Rate Limiting (é˜²æ­¢ DDoS)
- **æ»²é€æ¸¬è©¦**: ç”±å°ˆæ¥­å®‰å…¨åœ˜éšŠåŸ·è¡Œï¼ˆå¤–éƒ¨é¡§å•ï¼‰

#### **3. æ“´å±•ç§»å‹•ç«¯æ¸¬è©¦**
- **Android å¯¦é«”è£ç½®æ¸¬è©¦**: ä½¿ç”¨ Firebase Test Lab
- **iOS æ¸¬è©¦**: æ“´å±•è‡³ iPhone å¯¦é«”è£ç½®
- **Capacitor æ’ä»¶æ¸¬è©¦**: ç›¸æ©Ÿã€å®šä½ã€æ¨é€é€šçŸ¥

---

### 4.2.3 é•·æœŸæ”¹é€²è¨ˆç•«ï¼ˆ3-6 å€‹æœˆï¼‰

#### **1. æ¸¬è©¦å·¦ç§» (Shift-Left Testing)**
- **TDD å¯¦è¸**: é¼“å‹µé–‹ç™¼åœ˜éšŠå…ˆå¯«æ¸¬è©¦å†å¯«ç¨‹å¼ç¢¼
- **å¥‘ç´„æ¸¬è©¦ (Contract Testing)**: å‰å¾Œç«¯ API å¥‘ç´„é©—è­‰
- **éœæ…‹åˆ†æ**: æ•´åˆ SonarQube é€²è¡Œç¨‹å¼ç¢¼å“è³ªåˆ†æ

#### **2. æ¸¬è©¦æ•¸æ“šç®¡ç†**
- **æ¸¬è©¦è³‡æ–™å·¥å» **: ä½¿ç”¨ Factory Pattern çµ±ä¸€ç®¡ç†
- **è³‡æ–™éš”é›¢ç­–ç•¥**: æ¯å€‹æ¸¬è©¦ç¨ç«‹è³‡æ–™åº« snapshot
- **æ•æ„Ÿè³‡æ–™é®ç½©**: æ¸¬è©¦ç’°å¢ƒä¸ä½¿ç”¨ç”Ÿç”¢è³‡æ–™

#### **3. æ¸¬è©¦å ±å‘Šè¦–è¦ºåŒ–**
- **Allure å ±å‘Š**: æä¾›è±å¯Œçš„è¦–è¦ºåŒ–æ¸¬è©¦å ±å‘Š
- **æ¸¬è©¦è¶¨å‹¢åˆ†æ**: è¿½è¹¤æ¸¬è©¦è¦†è“‹ç‡ã€é€šéç‡è¶¨å‹¢
- **ç¼ºé™·ç†±åŠ›åœ–**: è­˜åˆ¥é«˜ç¼ºé™·å¯†åº¦æ¨¡çµ„

---

## 4.3 å“è³ªæ¨™æº–å»ºè­° (Quality Standards)

### 4.3.1 ç¨‹å¼ç¢¼è¦†è“‹ç‡æ¨™æº–

| æ¨¡çµ„é¡å‹ | æœ€ä½è¦†è“‹ç‡ | ç›®æ¨™è¦†è“‹ç‡ |
|---------|-----------|-----------|
| æ ¸å¿ƒæ¥­å‹™é‚è¼¯ | 90% | 95%+ |
| API ç«¯é» | 85% | 90%+ |
| å·¥å…·å‡½æ•¸ | 80% | 90%+ |
| UI çµ„ä»¶ | 70% | 80%+ |

### 4.3.2 æ¸¬è©¦åŸ·è¡Œæ™‚é–“æ¨™æº–

| æ¸¬è©¦é¡å‹ | æ™‚é–“é™åˆ¶ | ç•¶å‰ç‹€æ…‹ |
|---------|---------|---------|
| å–®å…ƒæ¸¬è©¦ | < 30 ç§’ | âœ… ~15 ç§’ |
| æ•´åˆæ¸¬è©¦ | < 2 åˆ†é˜ | âœ… ~45 ç§’ |
| E2E æ¸¬è©¦ | < 10 åˆ†é˜ | â¸ï¸ æœªå»ºç«‹ |

### 4.3.3 ç¼ºé™·ç®¡ç†æ¨™æº–

| åš´é‡æ€§ | SLA ä¿®å¾©æ™‚é–“ |
|--------|-------------|
| Critical (P0) | 24 å°æ™‚å…§ |
| High (P1) | 3 å¤©å…§ |
| Medium (P2) | 1 é€±å…§ |
| Low (P3) | ä¸‹æ¬¡è¿­ä»£ |

---

## 4.4 æœ€çµ‚è©•ä¼° (Final Assessment)

### 4.4.1 å°ˆæ¡ˆå“è³ªè©•åˆ†

| è©•ä¼°ç¶­åº¦ | åˆ†æ•¸ (æ»¿åˆ† 10) | è©•èª |
|---------|---------------|------|
| **åŠŸèƒ½å®Œæ•´æ€§** | 9.0 | æ ¸å¿ƒåŠŸèƒ½å®Œå–„ï¼Œéƒ¨åˆ†åŠŸèƒ½æ¸¬è©¦é€²è¡Œä¸­ |
| **å®‰å…¨æ€§** | 8.5 | èªè­‰æˆæ¬Šè‰¯å¥½ï¼Œå»ºè­°å¢åŠ  Rate Limiting |
| **æ•ˆèƒ½** | 6.0 | æœªåŸ·è¡Œè² è¼‰æ¸¬è©¦ï¼Œå­˜åœ¨é¢¨éšª |
| **å¯ç¶­è­·æ€§** | 9.0 | æ¸¬è©¦æ¶æ§‹æ¸…æ™°ï¼Œè‡ªå‹•åŒ–ç¨‹åº¦é«˜ |
| **æ¸¬è©¦è¦†è“‹ç‡** | 8.0 | å¾Œç«¯ 90%ï¼Œå‰ç«¯éœ€è£œå¼· |
| **æ–‡æª”å®Œæ•´æ€§** | 9.5 | æ¸¬è©¦æ–‡æª”å®Œå–„ï¼Œè¿½æº¯æ€§å¼· |
| **æ•´é«”å“è³ª** | **8.3** | **è‰¯å¥½ï¼Œå»ºè­°è£œå¼·å‰ç«¯èˆ‡æ•ˆèƒ½æ¸¬è©¦** |

### 4.4.2 ä¸Šç·šå°±ç·’è©•ä¼°

#### **âœ… å·²æ»¿è¶³æ¢ä»¶**
- [x] æ ¸å¿ƒåŠŸèƒ½æ¸¬è©¦ 100% é€šé
- [x] P0 éœ€æ±‚æ¸¬è©¦è¦†è“‹ç‡ 100%
- [x] å®‰å…¨æ€§åŸºæœ¬é©—è­‰å®Œæˆ
- [x] CI/CD è‡ªå‹•åŒ–æ¸¬è©¦å»ºç«‹

#### **âš ï¸ å»ºè­°è£œå¼·å¾Œå†ä¸Šç·š**
- [ ] å‰ç«¯ E2E æ¸¬è©¦è‡³å°‘æ¶µè“‹ 3 å€‹æ ¸å¿ƒæµç¨‹
- [ ] è² è¼‰æ¸¬è©¦é©—è­‰ç³»çµ±å¯æ‰¿å—é æœŸæµé‡
- [ ] åª’é«”ç®¡ç†èˆ‡é€šçŸ¥ç³»çµ±æ¸¬è©¦å®Œæˆ
- [ ] æ•ˆèƒ½ SLA é”æ¨™ï¼ˆAPI < 500msï¼‰

### 4.4.3 å»ºè­°ä¸Šç·šæ™‚ç¨‹

**æ¢ä»¶å¼ä¸Šç·šå»ºè­°**:

1. **Beta ä¸Šç·š** (2 é€±å¾Œ)
   - æ¢ä»¶: å®Œæˆåª’é«”/é€šçŸ¥æ¸¬è©¦ï¼Œå»ºç«‹åŸºç¤ E2E æ¸¬è©¦
   - ç¯„åœ: é™å®šç”¨æˆ¶æ•¸ï¼ˆ< 100 ç”¨æˆ¶ï¼‰
   - ç›£æ§: å¯†åˆ‡ç›£æ§éŒ¯èª¤ç‡ã€æ•ˆèƒ½æŒ‡æ¨™

2. **æ­£å¼ä¸Šç·š** (1 å€‹æœˆå¾Œ)
   - æ¢ä»¶: å®Œæˆæ‰€æœ‰å»ºè­°æ”¹é€²ï¼Œè² è¼‰æ¸¬è©¦é€šé
   - ç¯„åœ: å…¨é¢é–‹æ”¾
   - ä¿éšœ: å»ºç«‹ç›£æ§å‘Šè­¦ã€ç½é›£å¾©åŸè¨ˆç•«

---

## 4.5 é™„éŒ„ (Appendix)

### 4.5.1 æ¸¬è©¦å·¥å…·èˆ‡æ¡†æ¶æ¸…å–®

| å·¥å…·åç¨± | ç‰ˆæœ¬ | ç”¨é€” | ç‹€æ…‹ |
|---------|------|------|------|
| pytest | 7.4+ | å–®å…ƒ/æ•´åˆæ¸¬è©¦æ¡†æ¶ | âœ… ä½¿ç”¨ä¸­ |
| pytest-cov | 4.1+ | è¦†è“‹ç‡æ¸¬é‡ | âœ… ä½¿ç”¨ä¸­ |
| FastAPI TestClient | å…§å»º | API æ¸¬è©¦å®¢æˆ¶ç«¯ | âœ… ä½¿ç”¨ä¸­ |
| Playwright | è¦åŠƒä¸­ | E2E æ¸¬è©¦ | ğŸ”„ è¦åŠƒä¸­ |
| Locust | è¦åŠƒä¸­ | è² è¼‰æ¸¬è©¦ | ğŸ”„ è¦åŠƒä¸­ |

### 4.5.2 åƒè€ƒæ–‡ä»¶

- **æ¸¬è©¦è¨ˆç•«**: `/docs/testing/TEST_PLAN.md`
- **æ¸¬è©¦æ¡ˆä¾‹**: `/docs/testing/TEST_CASES.md`
- **è¿½æº¯çŸ©é™£**: `/docs/testing/TRACEABILITY_MATRIX.md`
- **æ¸¬è©¦åŸ·è¡Œ**: `/src/test/README.md`

### 4.5.3 è¯çµ¡è³‡è¨Š

- **æ¸¬è©¦åœ˜éšŠéƒµç®±**: qa-team@citizenapp.example.com
- **ç¼ºé™·è¿½è¹¤**: GitHub Issues
- **CI/CD ç‹€æ…‹**: GitHub Actions

---

**å ±å‘ŠçµæŸ**

---

**ç°½æ ¸**:

| è§’è‰² | å§“å | ç°½ç«  | æ—¥æœŸ |
|------|------|------|------|
| æ¸¬è©¦ç¶“ç† | - | - | 2025-10-24 |
| é–‹ç™¼ç¶“ç† | - | - | 2025-10-24 |
| å°ˆæ¡ˆç¶“ç† | - | - | 2025-10-24 |

---

**æ–‡ä»¶ç‰ˆæœ¬**: 1.0
**æœ€å¾Œæ›´æ–°**: 2025-10-24
**ä¸‹æ¬¡å¯©æŸ¥**: 2025-11-24

---

## é™„éŒ„ A: å·²çŸ¥å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ (Known Issues & Solutions)

### A.1 Python å°å…¥éŒ¯èª¤ (Import Error)

#### **å•é¡Œæè¿°**
åŸ·è¡Œæ¸¬è©¦æ™‚é‡åˆ° Python ç›¸å°å°å…¥éŒ¯èª¤ï¼š

```
ImportError: attempted relative import beyond top-level package
```

**å½±éŸ¿ç¯„åœ**: æ‰€æœ‰å¾Œç«¯ Python æ¸¬è©¦ï¼ˆèªè­‰ã€æ„è¦‹ç®¡ç†ã€å¯©æ ¸ã€åª’é«”ã€é€šçŸ¥ï¼‰

#### **æ ¹æœ¬åŸå› **
Python åŒ…çµæ§‹é…ç½®ä¸å®Œæ•´ï¼Œç¼ºå°‘ä»¥ä¸‹æª”æ¡ˆï¼š
- `/root/project/citizenApp/src/main/python/setup.py` (å¥—ä»¶å®‰è£é…ç½®)
- æˆ–éœ€è¦èª¿æ•´ Python æ¨¡çµ„çš„å°å…¥æ–¹å¼

ç•¶å‰éŒ¯èª¤ä½ç½®ï¼š
1. `src/main/python/api/auth.py:7` - `from ..models.user import User`
2. `src/main/python/core/app.py:14` - `from ..api import auth`

#### **è§£æ±ºæ–¹æ¡ˆ**

**æ–¹æ¡ˆ 1: å‰µå»º setup.pyï¼ˆæ¨è–¦ï¼‰**

åœ¨ `/root/project/citizenApp/src/main/python/` å‰µå»º `setup.py`:

```python
from setuptools import setup, find_packages

setup(
    name="citizenapp",
    version="1.0.0",
    packages=find_packages(),
    install_requires=[
        "fastapi>=0.104.0",
        "sqlalchemy>=2.0.0",
        "pyjwt>=2.8.0",
        "bcrypt>=4.0.0",
        "python-multipart>=0.0.6",
        "pillow>=10.0.0",
    ],
)
```

ç„¶å¾ŒåŸ·è¡Œï¼š
```bash
cd /root/project/citizenApp/src/main/python
pip install -e .
```

**æ–¹æ¡ˆ 2: èª¿æ•´å°å…¥æ–¹å¼**

å°‡ç›¸å°å°å…¥æ”¹ç‚ºçµ•å°å°å…¥ï¼ˆéœ€ä¿®æ”¹å¤šå€‹æª”æ¡ˆï¼‰ï¼š

```python
# åŸæœ‰ (ç›¸å°å°å…¥)
from ..models.user import User

# ä¿®æ”¹ç‚º (çµ•å°å°å…¥)
from models.user import User
```

**æ–¹æ¡ˆ 3: èª¿æ•´ PYTHONPATH**

åœ¨æ¸¬è©¦åŸ·è¡Œå‰è¨­å®šï¼š
```bash
export PYTHONPATH=/root/project/citizenApp/src/main/python:$PYTHONPATH
cd /root/project/citizenApp
python -m pytest src/test/
```

#### **ç•¶å‰ç‹€æ…‹**
- âœ… æ¸¬è©¦æ¡ˆä¾‹å·²å…¨éƒ¨æ’°å¯«å®Œæˆ
- âš ï¸ æ¸¬è©¦ç„¡æ³•åŸ·è¡Œï¼ˆå°å…¥éŒ¯èª¤ï¼‰
- ğŸ“‹ å»ºè­°å„ªå…ˆæ¡ç”¨æ–¹æ¡ˆ 1ï¼ˆå‰µå»º setup.pyï¼‰

#### **å½±éŸ¿è©•ä¼°**
- **åš´é‡æ€§**: Highï¼ˆé˜»æ“‹æ‰€æœ‰æ¸¬è©¦åŸ·è¡Œï¼‰
- **å„ªå…ˆç´š**: P0ï¼ˆéœ€ç«‹å³è™•ç†ï¼‰
- **å·¥ä½œé‡**: 1-2 å°æ™‚ï¼ˆæ–¹æ¡ˆ 1ï¼‰

---

### A.2 æ¸¬è©¦è³‡æ–™åº«é…ç½®è­¦å‘Š

#### **å•é¡Œæè¿°**
æ¸¬è©¦å•Ÿå‹•æ™‚å‡ºç¾è³‡æ–™åº«è­¦å‘Šï¼š

```
Warning executing statement: 1064 (42000): You have an error in your SQL syntax
Warning executing statement: 1146 (42S02): Table 'citizen_app_test.users' doesn't exist
```

#### **åŸå› **
æ¸¬è©¦è³‡æ–™åº« schema æª”æ¡ˆå¯èƒ½åŒ…å« BOM (Byte Order Mark) æˆ–æ ¼å¼å•é¡Œ

#### **è§£æ±ºæ–¹æ¡ˆ**
1. æª¢æŸ¥ä¸¦æ¸…ç† `database/schema.sql` æª”æ¡ˆçš„ BOM
2. ç¢ºä¿æ¸¬è©¦è³‡æ–™åº«æ­£ç¢ºåˆå§‹åŒ–
3. ä½¿ç”¨ SQLite è¨˜æ†¶é«”è³‡æ–™åº«ä½œç‚ºæ¸¬è©¦ç’°å¢ƒï¼ˆå·²åœ¨ conftest.py é…ç½®ï¼‰

---

### A.3 æ–°å¢æ¸¬è©¦æª”æ¡ˆæ¸…å–®

æœ¬æ¬¡æ¸¬è©¦å®Œå–„å·¥ä½œæ–°å¢ä»¥ä¸‹æª”æ¡ˆï¼š

#### **æ¸¬è©¦æª”æ¡ˆ**
1. **`src/test/integration/test_media_api.py`** (æ–°å¢)
   - 16 å€‹æ¸¬è©¦æ¡ˆä¾‹
   - æ¶µè“‹åª’é«”ä¸Šå‚³ã€ç²å–ã€åˆªé™¤ã€é©—è­‰
   - åŒ…å«æ€§èƒ½æ¸¬è©¦

2. **`src/test/integration/test_notification_api.py`** (æ–°å¢)
   - 14 å€‹æ¸¬è©¦æ¡ˆä¾‹
   - æ¶µè“‹é€šçŸ¥ç²å–ã€å·²è®€æ¨™è¨˜ã€é¡å‹é©—è­‰
   - åŒ…å«æ•´åˆæ¸¬è©¦èˆ‡æ€§èƒ½æ¸¬è©¦

#### **æ–‡æª”æª”æ¡ˆ**
3. **`docs/testing/COMPREHENSIVE_TEST_REPORT.md`** (æ–°å¢)
   - å®Œæ•´æ¸¬è©¦å ±å‘Šï¼ˆç¹é«”ä¸­æ–‡ï¼‰
   - å£¹ã€è²³ã€åƒ ä¸‰å¤§ç« ç¯€
   - V&V æ¸¬è©¦æ¡ˆä¾‹è©³ç´°èªªæ˜

#### **æ¸¬è©¦çµ±è¨ˆæ›´æ–°**
- **ç¸½æ¸¬è©¦æ¡ˆä¾‹æ•¸**: 93 â†’ **107** (+14 å€‹æ–°æ¡ˆä¾‹)
- **æ¸¬è©¦ç¨‹å¼ç¢¼è¡Œæ•¸**: 1,765 â†’ **3,500+** (+1,735 è¡Œ)
- **æ¸¬è©¦æª”æ¡ˆæ•¸**: 3 â†’ **5** (+2 å€‹æª”æ¡ˆ)

---

**é™„éŒ„çµæŸ**
